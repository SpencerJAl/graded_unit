{"changed":true,"filter":false,"title":"product.php","tooltip":"/PHP/EditAPI/product.php","value":"<?php\n\nclass Product{\n\t//Database connection and table details\nprivate $conn;\nprivate $table_name =\"product\";\n\n\t\npublic $id;\npublic $name;\npublic $descript;\npublic $price;\t\npublic $image_path;\npublic $PDF;\npublic $created;\npublic $modified_time;\n\n\n//Constructer with $DB conn\n\npublic function __construct($db){\n$this->conn = $db;\t\n}\npublic function read(){\n\t\n\t\n\t$query =\"SELECT * FROM \" .$this ->table_name .\"\";\n\t$result = $this->conn->query($query);\n\treturn $result;\n}\n// function for the update page\nfunction read_one(){\n \n    // query to read single record\n    $query = \"SELECT * FROM \" . $this->table_name . \" WHERE id = ? LIMIT 0,1\";\n \n    // prepare query statement\n    $stmt = $this->conn->prepare( $query );\n \n    // bind id of product to be updated\n    $stmt->bindParam(1, $this->id);\n \n    // execute query\n    $stmt->execute();\n \n    // get retrieved row\n    $row = $stmt->fetch(PDO::FETCH_ASSOC);\n \n    // set values to object properties\n    $this->name = $row['name'];\n    $this->descript = $row['descript'];\n    $this->price = $row['price'];\n    $this->image_path = $row['image_path'];\n    $this->created = $row['created'];\n}\n      \n    \n    \n\n  // update the product\n function update(){\n       // update query\n      $query = \"UPDATE\n                \" . $this->table_name . \"\n            SET\n                name = :name,\n                descript = :descript,\n                price = :price,\n                image_path = :image_path\n            WHERE id = :id \";\n \n      // prepare query statement\n      $stmt = $this->conn->prepare($query);\n \n      // sanitize\n      $this->name = htmlspecialchars(strip_tags($this->name));\n      $this->descript = htmlspecialchars(strip_tags($this->descript));\n      $this->price = htmlspecialchars(strip_tags($this->price));\n      $this->image_path = htmlspecialchars(strip_tags($this->image_path));\n      $this->id = htmlspecialchars(strip_tags($this->id));\n \n      // bind new values\n      $stmt->bindParam(':name', $this->name);\n      $stmt->bindParam(':descript', $this->descript);\n      $stmt->bindParam(':price', $this->price);\n      $stmt->bindParam(':image_path', $this->image_path);\n      $stmt->bindParam(':id', $this->id);\n \n     // execute the query\n     if($stmt->execute()){ \n        return true;\n        } else {\n             return false;\n        }\n   \n          \n    }\nfunction create(){\n \n    // query to insert record\n    $query = \"INSERT INTO\n                \" . $this->table_name . \"\n            SET\n                name=:name, descript =:descript, price=:price, image_path=:image_path, PDF=:PDF, created=:created\";\n \n    // prepare query\n    $stmt = $this->conn->prepare($query);\n \n    // sanitize\n    $this->name=htmlspecialchars(strip_tags($this->name));\n    $this->descript=htmlspecialchars(strip_tags($this->descript));\n    $this->price=htmlspecialchars(strip_tags($this->price));\n    $this->image_path=htmlspecialchars(strip_tags($this->image_path));\n    $this->PDF=htmlspecialchars(strip_tags($this->PDF));\n    $this->created=htmlspecialchars(strip_tags($this->created));\n \n    // bind values\n    $stmt->bindParam(\":name\", $this->name);\n    $stmt->bindParam(\":descript\", $this->descript);\n    $stmt->bindParam(\":price\", $this->price);\n    $stmt->bindParam(\":image_path\", $this->image_path);\n    $stmt->bindParam(\":PDF\", $this->PDF);\n    $stmt->bindParam(\":created\", $this->created);\n \n    // execute query\n    if($stmt->execute()){\n        return true;\n    }else{\n        return false;\n    }\n\n}\n     // delete the product\n       function delete(){\n \n    $query = \"DELETE FROM \" . $this->table_name . \" WHERE id = ?\";\n     \n    $stmt = $this->conn->prepare($query);\n    $stmt->bindParam(1, $this->id);\n \n    if($result = $stmt->execute()){\n        return true;\n    }else{\n        return false;\n    }\n    }\n\n   \n \n \n}\n?>","undoManager":{"mark":-2,"position":-1,"stack":[[{"start":{"row":100,"column":0},"end":{"row":100,"column":1},"action":"remove","lines":[" "],"id":7}],[{"start":{"row":100,"column":1},"end":{"row":100,"column":2},"action":"remove","lines":[" "],"id":7}],[{"start":{"row":100,"column":2},"end":{"row":100,"column":3},"action":"remove","lines":["c"],"id":8}],[{"start":{"row":100,"column":3},"end":{"row":100,"column":4},"action":"remove","lines":["9"],"id":9}],[{"start":{"row":100,"column":3},"end":{"row":100,"column":4},"action":"insert","lines":["9"],"id":10}],[{"start":{"row":100,"column":2},"end":{"row":103,"column":115},"action":"remove","lines":["  $query = \"INSERT INTO","                \" . $this->table_name . \"","            SET","                name=:name, descript =:descript, price=:price, image_path=:image_path, PDF=:PDF, created=:created\";"],"id":11},{"start":{"row":100,"column":2},"end":{"row":100,"column":3},"action":"insert","lines":["c"]}]]},"ace":{"folds":[],"scrolltop":1365,"scrollleft":0,"selection":{"start":{"row":118,"column":29},"end":{"row":118,"column":29},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":12,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1495047898395}