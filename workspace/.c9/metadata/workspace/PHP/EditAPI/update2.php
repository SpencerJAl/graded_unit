{"filter":false,"title":"update2.php","tooltip":"/PHP/EditAPI/update2.php","undoManager":{"mark":2,"position":2,"stack":[[{"start":{"row":0,"column":0},"end":{"row":120,"column":3},"action":"insert","lines":["(document).ready(function(){"," ","","// show html form when 'update product' button was clicked","  ","$(document).on('click', '.btn-info', function(){","","var id = $(this).attr('data-id');","  $(\".row\").hide();","","$(\"h1\").html(\"Update Product\");"," ","// read one record based on given product id","","$.getJSON(\"read1.php?id=\" + id, function(data){","","// values will be used to fill out our form","  ","var name = data.name;","var descript = data.descript;","var price = data.price;","var image_path = data.image_path;"," ","// we used the 'required' html5 property to prevent empty fields","var update_product = \"\";"," ","update_product +=\"<form id='update-product-form' action='#' method='post' border='0'>\";"," ","update_product +=\"<table class='table'>\";"," ","        // name field","     update_product +=\"<tr>\";","","update_product +=\"<td>Name</td>\";","   ","update_product +=\"<td><input value=\\\"\" + name + \"\\\" type='text' name='name' class='form-control' required /></td>\";"," ","update_product +=\"</tr>\";"," ","        // price field","update_product +=\"<tr>\";","        update_product +=\"<td>Price</td>\";","","update_product +=\"<td><input value=\\\"\" + price + \"\\\" type='number' min='1' name='price' class='form-control' required /></td>\";","update_product +=\"</tr>\";"," ","        // description field"," ","update_product +=\"<tr>\";"," ","update_product +=\"<td>Description</td>\";","update_product +=\"<td><textarea name='descript' class='form-control' required>\" + descript + \"</textarea></td>\";","update_product +=\"</tr>\";"," ","        //image upload feild","        update_product +=\"<tr>\";","update_product +=\"<td>Image Name (With Image Path)</td>\";","","update_product +=\"<td><textarea name='image_path' class='form-control' required>\" + image_path+ \"</textarea></td>\";","","update_product +=\"</tr>\";"," ","        update_product +=\"<tr>\";"," ","// hidden 'product id' to identify which record to delete","    ","update_product +=\"<td><input value=\\\"\" + id + \"\\\" name='id' type='hidden' /></td>\";"," "," ","// button to submit form","  ","update_product +=\"<td>\";"," ","update_product +=\"<button type='submit' class='btn btn-info'>\";"," ","update_product +=\"<span class='glyphicon glyphicon-edit'></span> Update Product\";"," ","update_product +=\"</button>\";","update_product +=\"</td>\";","update_product +=\"</tr>\";","update_product +=\"</table>\";","update_product +=\"</form>\";","","$(\"#app\").append(update_product);","});"," "," ","});","","","","// will run if 'create product' form was submitted","","$(document).on('submit', '#update-product-form', function(){","","  ","   var form_data=JSON.stringify($(this).serializeObject());","     ","     // submit form data to api","$.ajax({","    url: \"update.php\",","    type : \"POST\",","    contentType : 'application/json',","    data : form_data,","    success : function(result) {","        // product was created, go back to products list","        showProducts();","    },","    error: function(xhr, resp, text) {","        // show error to console","        console.log(xhr, resp, text);","    }","});","     ","    return false;","});","","","","    ","});"],"id":1}],[{"start":{"row":0,"column":0},"end":{"row":120,"column":3},"action":"remove","lines":["(document).ready(function(){"," ","","// show html form when 'update product' button was clicked","  ","$(document).on('click', '.btn-info', function(){","","var id = $(this).attr('data-id');","  $(\".row\").hide();","","$(\"h1\").html(\"Update Product\");"," ","// read one record based on given product id","","$.getJSON(\"read1.php?id=\" + id, function(data){","","// values will be used to fill out our form","  ","var name = data.name;","var descript = data.descript;","var price = data.price;","var image_path = data.image_path;"," ","// we used the 'required' html5 property to prevent empty fields","var update_product = \"\";"," ","update_product +=\"<form id='update-product-form' action='#' method='post' border='0'>\";"," ","update_product +=\"<table class='table'>\";"," ","        // name field","     update_product +=\"<tr>\";","","update_product +=\"<td>Name</td>\";","   ","update_product +=\"<td><input value=\\\"\" + name + \"\\\" type='text' name='name' class='form-control' required /></td>\";"," ","update_product +=\"</tr>\";"," ","        // price field","update_product +=\"<tr>\";","        update_product +=\"<td>Price</td>\";","","update_product +=\"<td><input value=\\\"\" + price + \"\\\" type='number' min='1' name='price' class='form-control' required /></td>\";","update_product +=\"</tr>\";"," ","        // description field"," ","update_product +=\"<tr>\";"," ","update_product +=\"<td>Description</td>\";","update_product +=\"<td><textarea name='descript' class='form-control' required>\" + descript + \"</textarea></td>\";","update_product +=\"</tr>\";"," ","        //image upload feild","        update_product +=\"<tr>\";","update_product +=\"<td>Image Name (With Image Path)</td>\";","","update_product +=\"<td><textarea name='image_path' class='form-control' required>\" + image_path+ \"</textarea></td>\";","","update_product +=\"</tr>\";"," ","        update_product +=\"<tr>\";"," ","// hidden 'product id' to identify which record to delete","    ","update_product +=\"<td><input value=\\\"\" + id + \"\\\" name='id' type='hidden' /></td>\";"," "," ","// button to submit form","  ","update_product +=\"<td>\";"," ","update_product +=\"<button type='submit' class='btn btn-info'>\";"," ","update_product +=\"<span class='glyphicon glyphicon-edit'></span> Update Product\";"," ","update_product +=\"</button>\";","update_product +=\"</td>\";","update_product +=\"</tr>\";","update_product +=\"</table>\";","update_product +=\"</form>\";","","$(\"#app\").append(update_product);","});"," "," ","});","","","","// will run if 'create product' form was submitted","","$(document).on('submit', '#update-product-form', function(){","","  ","   var form_data=JSON.stringify($(this).serializeObject());","     ","     // submit form data to api","$.ajax({","    url: \"update.php\",","    type : \"POST\",","    contentType : 'application/json',","    data : form_data,","    success : function(result) {","        // product was created, go back to products list","        showProducts();","    },","    error: function(xhr, resp, text) {","        // show error to console","        console.log(xhr, resp, text);","    }","});","     ","    return false;","});","","","","    ","});"],"id":2}],[{"start":{"row":0,"column":0},"end":{"row":41,"column":2},"action":"insert","lines":["<?php","// required headers","header(\"Access-Control-Allow-Origin: *\");","header(\"Content-Type: application/json; charset=UTF-8\");","header(\"Access-Control-Allow-Methods: POST\");","header(\"Access-Control-Max-Age: 3600\");","header(\"Access-Control-Allow-Headers: Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With\");"," //Include database objects","include_once 'database.php';","include_once 'product.php';","//get database connection","$database = new Database();","$db = $database->getConnection();","","//Prepare new object","$product = new Product($db);","","//get id of product ot be edited.","$data = json_decode(file_get_contents(\"php://input\"));","// set ID property of product to be edited","$product->id = $data->id;"," ","// set product property values","$product->name = $data->name;","$product->price = $data->price;","$product->descript = $data->descript;","$product->image_path = $data->image_path;"," ","// update the product","if($product->update()){","    echo '{';","        echo '\"message\": \"Product was updated.\"';","    echo '}';","}"," ","// if unable to update the product, tell the user","else{","    echo '{';","        echo '\"message\": \"Unable to update product.\"';","    echo '}';","}","?>"],"id":3}]]},"ace":{"folds":[],"scrolltop":180,"scrollleft":0,"selection":{"start":{"row":17,"column":22},"end":{"row":17,"column":22},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":50,"mode":"ace/mode/php"}},"timestamp":1495021703705,"hash":"5d016dddc1e7097eab2d3b92f5716e38982a1f6d"}