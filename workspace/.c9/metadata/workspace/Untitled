{"changed":true,"filter":false,"title":"Untitled","tooltip":"/Untitled","value":"/*~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~\n\tCopyright (c) 2012 Brett Wejrowski\n\n\twojodesign.com\n\tsimplecartjs.org\n\thttp://github.com/wojodesign/simplecart-js\n\n\tVERSION 3.0.5\n\n\tDual licensed under the MIT or GPL licenses.\n~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~*/\n/*jslint browser: true, unparam: true, white: true, nomen: true, regexp: true, maxerr: 50, indent: 4 */\n\n(function (window, document) {\n\t/*global HTMLElement */\n\n\tvar typeof_string\t\t\t= typeof \"\",\n\t\ttypeof_undefined\t\t= typeof undefined,\n\t\ttypeof_function\t\t\t= typeof function () {},\n\t\ttypeof_object\t\t\t= typeof {},\n\t\tisTypeOf\t\t\t\t= function (item, type) { return typeof item === type; },\n\t\tisString\t\t\t\t= function (item) { return isTypeOf(item, typeof_string); },\n\t\tisUndefined\t\t\t\t= function (item) { return isTypeOf(item, typeof_undefined); },\n\t\tisFunction\t\t\t\t= function (item) { return isTypeOf(item, typeof_function); },\n\n\t\tisObject\t\t\t\t= function (item) { return isTypeOf(item, typeof_object); },\n\t\t//Returns true if it is a DOM element\n\t\tisElement\t\t\t\t= function (o) {\n\t\t\treturn typeof HTMLElement === \"object\" ? o instanceof HTMLElement : typeof o === \"object\" && o.nodeType === 1 && typeof o.nodeName === \"string\";\n\t\t},\n\n\n\n\t\tgenerateSimpleCart = function (space) {\n\n\t\t\t// stealing this from selectivizr\n\t\t\tvar selectorEngines = {\n\t\t\t\t\"MooTools\"\t\t\t\t\t\t\t: \"$$\",\n\t\t\t\t\"Prototype\"\t\t\t\t\t\t\t: \"$$\",\n\t\t\t\t\"jQuery\"\t\t\t\t\t\t\t: \"*\"\n\t\t\t},\n\n\n\t\t\t\t// local variables for internal use\n\t\t\t\titem_id\t\t\t\t\t= 0,\n\t\t\t\titem_id_namespace\t\t= \"SCI-\",\n\t\t\t\tsc_items\t\t\t\t= {},\n\t\t\t\tnamespace\t\t\t\t= space || \"simpleCart\",\n\t\t\t\tselectorFunctions\t\t= {},\n\t\t\t\teventFunctions\t\t\t= {},\n\t\t\t\tbaseEvents\t\t\t\t= {},\n\n\t\t\t\t// local references\n\t\t\t\tlocalStorage\t\t\t= window.localStorage,\n\t\t\t\tconsole\t\t\t\t\t= window.console || { msgs: [], log: function (msg) { console.msgs.push(msg); } },\n\n\t\t\t\t// used in views \n\t\t\t\t_VALUE_\t\t= 'value',\n\t\t\t\t_TEXT_\t\t= 'text',\n\t\t\t\t_HTML_\t\t= 'html',\n\t\t\t\t_CLICK_\t\t= 'click',\n\n\t\t\t\t// Currencies\n\t\t\t\tcurrencies = {\n\t\t\t\t\t\"USD\": { code: \"USD\", symbol: \"&#36;\", name: \"US Dollar\" },\n\t\t\t\t\t\"AUD\": { code: \"AUD\", symbol: \"&#36;\", name: \"Australian Dollar\" },\n\t\t\t\t\t\"BRL\": { code: \"BRL\", symbol: \"R&#36;\", name: \"Brazilian Real\" },\n\t\t\t\t\t\"CAD\": { code: \"CAD\", symbol: \"&#36;\", name: \"Canadian Dollar\" },\n\t\t\t\t\t\"CZK\": { code: \"CZK\", symbol: \"&nbsp;&#75;&#269;\", name: \"Czech Koruna\", after: true },\n\t\t\t\t\t\"DKK\": { code: \"DKK\", symbol: \"DKK&nbsp;\", name: \"Danish Krone\" },\n\t\t\t\t\t\"EUR\": { code: \"EUR\", symbol: \"&euro;\", name: \"Euro\" },\n\t\t\t\t\t\"HKD\": { code: \"HKD\", symbol: \"&#36;\", name: \"Hong Kong Dollar\" },\n\t\t\t\t\t\"HUF\": { code: \"HUF\", symbol: \"&#70;&#116;\", name: \"Hungarian Forint\" },\n\t\t\t\t\t\"ILS\": { code: \"ILS\", symbol: \"&#8362;\", name: \"Israeli New Sheqel\" },\n\t\t\t\t\t\"JPY\": { code: \"JPY\", symbol: \"&yen;\", name: \"Japanese Yen\", accuracy: 0 },\n\t\t\t\t\t\"MXN\": { code: \"MXN\", symbol: \"&#36;\", name: \"Mexican Peso\" },\n\t\t\t\t\t\"NOK\": { code: \"NOK\", symbol: \"NOK&nbsp;\", name: \"Norwegian Krone\" },\n\t\t\t\t\t\"NZD\": { code: \"NZD\", symbol: \"&#36;\", name: \"New Zealand Dollar\" },\n\t\t\t\t\t\"PLN\": { code: \"PLN\", symbol: \"PLN&nbsp;\", name: \"Polish Zloty\" },\n\t\t\t\t\t\"GBP\": { code: \"GBP\", symbol: \"&pound;\", name: \"Pound Sterling\" },\n\t\t\t\t\t\"SGD\": { code: \"SGD\", symbol: \"&#36;\", name: \"Singapore Dollar\" },\n\t\t\t\t\t\"SEK\": { code: \"SEK\", symbol: \"SEK&nbsp;\", name: \"Swedish Krona\" },\n\t\t\t\t\t\"CHF\": { code: \"CHF\", symbol: \"CHF&nbsp;\", name: \"Swiss Franc\" },\n\t\t\t\t\t\"THB\": { code: \"THB\", symbol: \"&#3647;\", name: \"Thai Baht\" },\n\t\t\t\t\t\"BTC\": { code: \"BTC\", symbol: \" BTC\", name: \"Bitcoin\", accuracy: 4, after: true\t}\n\t\t\t\t},\n\n\t\t\t\t// default options\n\t\t\t\tsettings = {\n\t\t\t\t\tcheckout\t\t\t\t: { type: \"PayPal\", email: \"you@yours.com\" },\n\t\t\t\t\tcurrency\t\t\t\t: \"USD\",\n\t\t\t\t\tlanguage\t\t\t\t: \"english-us\",\n\n\t\t\t\t\tcartStyle\t\t\t\t: \"div\",\n\t\t\t\t\tcartColumns\t\t\t: [\n\t\t\t\t\t\t{ attr: \"name\", label: \"Name\" },\n\t\t\t\t\t\t{ attr: \"price\", label: \"Price\", view: 'currency' },\n\t\t\t\t\t\t{ view: \"decrement\", label: false },\n\t\t\t\t\t\t{ attr: \"quantity\", label: \"Qty\" },\n\t\t\t\t\t\t{ view: \"increment\", label: false },\n\t\t\t\t\t\t{ attr: \"total\", label: \"SubTotal\", view: 'currency' },\n\t\t\t\t\t\t{ view: \"remove\", text: \"Remove\", label: false }\n\t\t\t\t\t],\n\n\t\t\t\t\texcludeFromCheckout\t: ['thumb'],\n\n\t\t\t\t\tshippingFlatRate\t\t: 0,\n\t\t\t\t\tshippingQuantityRate\t: 0,\n\t\t\t\t\tshippingTotalRate\t\t: 0,\n\t\t\t\t\tshippingCustom\t\t: null,\n\n\t\t\t\t\ttaxRate\t\t\t\t: 0,\n\t\t\t\t\t\n\t\t\t\t\ttaxShipping\t\t\t: false,\n\n\t\t\t\t\tdata\t\t\t\t: {}\n\n\t\t\t\t},\n\n\n\t\t\t\t// main simpleCart object, function call is used for setting options\n\t\t\t\tsimpleCart = function (options) {\n\t\t\t\t\t// shortcut for simpleCart.ready\n\t\t\t\t\tif (isFunction(options)) {\n\t\t\t\t\t\treturn simpleCart.ready(options);\n\t\t\t\t\t}\n\n\t\t\t\t\t// set options\n\t\t\t\t\tif (isObject(options)) {\n\t\t\t\t\t\treturn simpleCart.extend(settings, options);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// selector engine\n\t\t\t\t$engine,\n\n\t\t\t\t// built in cart views for item cells\n\t\t\t\tcartColumnViews;\n\n\t\t\t// function for extending objects\n\t\t\tsimpleCart.extend = function (target, opts) {\n\t\t\t\tvar next;\n\n\t\t\t\tif (isUndefined(opts)) {\n\t\t\t\t\topts = target;\n\t\t\t\t\ttarget = simpleCart;\n\t\t\t\t}\n\n\t\t\t\tfor (next in opts) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(opts, next)) {\n\t\t\t\t\t\ttarget[next] = opts[next];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn target;\n\t\t\t};\n\n\t\t\t// create copy function\n\t\t\tsimpleCart.extend({\n\t\t\t\tcopy: function (n) {\n\t\t\t\t\tvar cp = generateSimpleCart(n);\n\t\t\t\t\tcp.init();\n\t\t\t\t\treturn cp;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// add in the core functionality\n\t\t\tsimpleCart.extend({\n\n\t\t\t\tisReady: false,\n\n\t\t\t\t// this is where the magic happens, the add function\n\t\t\t\tadd: function (values, opt_quiet) {\n\t\t\t\t\tvar info\t\t= values || {},\n\t\t\t\t\t\tnewItem\t\t= new simpleCart.Item(info),\n\t\t\t\t\t\taddItem \t= true,\n\t\t\t\t\t\t// optionally supress event triggers\n\t\t\t\t\t\tquiet \t\t= opt_quiet === true ? opt_quiet : false,\n\t\t\t\t\t\toldItem;\n\n\t\t\t\t\t// trigger before add event\n\t\t\t\t\tif (!quiet) {\n\t\t\t\t\t  \taddItem = simpleCart.trigger('beforeAdd', [newItem]);\n\t\t\t\t\t\n\t\t\t\t\t\tif (addItem === false) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// if the new item already exists, increment the value\n\t\t\t\t\toldItem = simpleCart.has(newItem);\n\t\t\t\t\tif (oldItem) {\n\t\t\t\t\t\toldItem.increment(newItem.quantity());\n\t\t\t\t\t\tnewItem = oldItem;\n\n\t\t\t\t\t// otherwise add the item\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsc_items[newItem.id()] = newItem;\n\t\t\t\t\t}\n\n\t\t\t\t\t// update the cart\n\t\t\t\t\tsimpleCart.update();\n\n\t\t\t\t\tif (!quiet) {\n\t\t\t\t\t\t// trigger after add event\n\t\t\t\t\t\tsimpleCart.trigger('afterAdd', [newItem, isUndefined(oldItem)]);\n\t\t\t\t\t}\n\n\t\t\t\t\t// return a reference to the added item\n\t\t\t\t\treturn newItem;\n\t\t\t\t},\n\n\n\t\t\t\t// iteration function\n\t\t\t\teach: function (array, callback) {\n\t\t\t\t\tvar next,\n\t\t\t\t\t\tx = 0,\n\t\t\t\t\t\tresult,\n\t\t\t\t\t\tcb,\n\t\t\t\t\t\titems;\n\n\t\t\t\t\tif (isFunction(array)) {\n\t\t\t\t\t\tcb = array;\n\t\t\t\t\t\titems = sc_items;\n\t\t\t\t\t} else if (isFunction(callback)) {\n\t\t\t\t\t\tcb = callback;\n\t\t\t\t\t\titems = array;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (next in items) {\n\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(items, next)) {\n\t\t\t\t\t\t\tresult = cb.call(simpleCart, items[next], x, next);\n\t\t\t\t\t\t\tif (result === false) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tx += 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tfind: function (id) {\n\t\t\t\t\tvar items = [];\n\n\t\t\t\t\t// return object for id if it exists\n\t\t\t\t\tif (isObject(sc_items[id])) {\n\t\t\t\t\t\treturn sc_items[id];\n\t\t\t\t\t}\n\t\t\t\t\t// search through items with the given criteria\n\t\t\t\t\tif (isObject(id)) {\n\t\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\t\tvar match = true;\n\t\t\t\t\t\t\tsimpleCart.each(id, function (val, x, attr) {\n\n\t\t\t\t\t\t\t\tif (isString(val)) {\n\t\t\t\t\t\t\t\t\t// less than or equal to\n\t\t\t\t\t\t\t\t\tif (val.match(/<=.*/)) {\n\t\t\t\t\t\t\t\t\t\tval = parseFloat(val.replace('<=', ''));\n\t\t\t\t\t\t\t\t\t\tif (!(item.get(attr) && parseFloat(item.get(attr)) <= val)) {\n\t\t\t\t\t\t\t\t\t\t\tmatch = false;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// less than\n\t\t\t\t\t\t\t\t\t} else if (val.match(/</)) {\n\t\t\t\t\t\t\t\t\t\tval = parseFloat(val.replace('<', ''));\n\t\t\t\t\t\t\t\t\t\tif (!(item.get(attr) && parseFloat(item.get(attr)) < val)) {\n\t\t\t\t\t\t\t\t\t\t\tmatch = false;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// greater than or equal to\n\t\t\t\t\t\t\t\t\t} else if (val.match(/>=/)) {\n\t\t\t\t\t\t\t\t\t\tval = parseFloat(val.replace('>=', ''));\n\t\t\t\t\t\t\t\t\t\tif (!(item.get(attr) && parseFloat(item.get(attr)) >= val)) {\n\t\t\t\t\t\t\t\t\t\t\tmatch = false;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// greater than\n\t\t\t\t\t\t\t\t\t} else if (val.match(/>/)) {\n\t\t\t\t\t\t\t\t\t\tval = parseFloat(val.replace('>', ''));\n\t\t\t\t\t\t\t\t\t\tif (!(item.get(attr) && parseFloat(item.get(attr)) > val)) {\n\t\t\t\t\t\t\t\t\t\t\tmatch = false;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// equal to\n\t\t\t\t\t\t\t\t\t} else if (!(item.get(attr) && item.get(attr) === val)) {\n\t\t\t\t\t\t\t\t\t\tmatch = false;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// equal to non string\n\t\t\t\t\t\t\t\t} else if (!(item.get(attr) && item.get(attr) === val)) {\n\t\t\t\t\t\t\t\t\tmatch = false;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn match;\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t// add the item if it matches\n\t\t\t\t\t\t\tif (match) {\n\t\t\t\t\t\t\t\titems.push(item);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn items;\n\t\t\t\t\t}\n\n\t\t\t\t\t// if no criteria is given we return all items\n\t\t\t\t\tif (isUndefined(id)) {\n\n\t\t\t\t\t\t// use a new array so we don't give a reference to the\n\t\t\t\t\t\t// cart's item array\n\t\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\t\titems.push(item);\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn items;\n\t\t\t\t\t}\n\n\t\t\t\t\t// return empty array as default\n\t\t\t\t\treturn items;\n\t\t\t\t},\n\n\t\t\t\t// return all items\n\t\t\t\titems: function () {\n\t\t\t\t\treturn this.find();\n\t\t\t\t},\n\n\t\t\t\t// check to see if item is in the cart already\n\t\t\t\thas: function (item) {\n\t\t\t\t\tvar match = false;\n\n\t\t\t\t\tsimpleCart.each(function (testItem) {\n\t\t\t\t\t\tif (testItem.equals(item)) {\n\t\t\t\t\t\t\tmatch = testItem;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn match;\n\t\t\t\t},\n\n\t\t\t\t// empty the cart\n\t\t\t\tempty: function () {\n\t\t\t\t\t// remove each item individually so we see the remove events\n\t\t\t\t\tvar newItems = {};\n\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\t// send a param of true to make sure it doesn't\n\t\t\t\t\t\t// update after every removal\n\t\t\t\t\t\t// keep the item if the function returns false,\n\t\t\t\t\t\t// because we know it has been prevented \n\t\t\t\t\t\t// from being removed\n\t\t\t\t\t\tif (item.remove(true) === false) {\n\t\t\t\t\t\t\tnewItems[item.id()] = item\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tsc_items = newItems;\n\t\t\t\t\tsimpleCart.update();\n\t\t\t\t},\n\n\n\t\t\t\t// functions for accessing cart info\n\t\t\t\tquantity: function () {\n\t\t\t\t\tvar quantity = 0;\n\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\tquantity += item.quantity();\n\t\t\t\t\t});\n\t\t\t\t\treturn quantity;\n\t\t\t\t},\n\n\t\t\t\ttotal: function () {\n\t\t\t\t\tvar total = 0;\n\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\ttotal += item.total();\n\t\t\t\t\t});\n\t\t\t\t\treturn total;\n\t\t\t\t},\n\n\t\t\t\tgrandTotal: function () {\n\t\t\t\t\treturn simpleCart.total() + simpleCart.tax() + simpleCart.shipping();\n\t\t\t\t},\n\n\n\t\t\t\t// updating functions\n\t\t\t\tupdate: function () {\n\t\t\t\t\tsimpleCart.save();\n\t\t\t\t\tsimpleCart.trigger(\"update\");\n\t\t\t\t},\n\n\t\t\t\tinit: function () {\n\t\t\t\t\tsimpleCart.load();\n\t\t\t\t\tsimpleCart.update();\n\t\t\t\t\tsimpleCart.ready();\n\t\t\t\t},\n\n\t\t\t\t// view management\n\t\t\t\t$: function (selector) {\n\t\t\t\t\treturn new simpleCart.ELEMENT(selector);\n\t\t\t\t},\n\n\t\t\t\t$create: function (tag) {\n\t\t\t\t\treturn simpleCart.$(document.createElement(tag));\n\t\t\t\t},\n\n\t\t\t\tsetupViewTool: function () {\n\t\t\t\t\tvar members, member, context = window, engine;\n\n\t\t\t\t\t// Determine the \"best fit\" selector engine\n\t\t\t\t\tfor (engine in selectorEngines) {\n\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(selectorEngines, engine) && window[engine]) {\n\t\t\t\t\t\t\tmembers = selectorEngines[engine].replace(\"*\", engine).split(\".\");\n\t\t\t\t\t\t\tmember = members.shift();\n\t\t\t\t\t\t\tif (member) {\n\t\t\t\t\t\t\t\tcontext = context[member];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (typeof context === \"function\") {\n\t\t\t\t\t\t\t\t// set the selector engine and extend the prototype of our\n\t\t\t\t\t\t\t\t// element wrapper class\n\t\t\t\t\t\t\t\t$engine = context;\n\t\t\t\t\t\t\t\tsimpleCart.extend(simpleCart.ELEMENT._, selectorFunctions[engine]);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// return a list of id's in the cart\n\t\t\t\tids: function () {\n\t\t\t\t\tvar ids = [];\n\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\tids.push(item.id());\n\t\t\t\t\t});\n\t\t\t\t\treturn ids;\n\n\t\t\t\t},\n\n\n\t\t\t\t// storage\n\t\t\t\tsave: function () {\n\t\t\t\t\tsimpleCart.trigger('beforeSave');\n\n\t\t\t\t\tvar items = {};\n\n\t\t\t\t\t// save all the items\n\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\titems[item.id()] = simpleCart.extend(item.fields(), item.options());\n\t\t\t\t\t});\n\n\t\t\t\t\tlocalStorage.setItem(namespace + \"_items\", JSON.stringify(items));\n\n\t\t\t\t\tsimpleCart.trigger('afterSave');\n\t\t\t\t},\n\n\t\t\t\tload: function () {\n\n\t\t\t\t\t// empty without the update\n\t\t\t\t\tsc_items = {};\n\n\t\t\t\t\tvar items = localStorage.getItem(namespace + \"_items\");\n\n\t\t\t\t\tif (!items) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// we wrap this in a try statement so we can catch \n\t\t\t\t\t// any json parsing errors. no more stick and we\n\t\t\t\t\t// have a playing card pluckin the spokes now...\n\t\t\t\t\t// soundin like a harley.\n\t\t\t\t\ttry {\n\t\t\t\t\t\tsimpleCart.each(JSON.parse(items), function (item) {\n\t\t\t\t\t\t\tsimpleCart.add(item, true);\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch (e){\n\t\t\t\t\t\tsimpleCart.error( \"Error Loading data: \" + e );\n\t\t\t\t\t}\n\n\n\t\t\t\t\tsimpleCart.trigger('load');\n\t\t\t\t},\n\n\t\t\t\t// ready function used as a shortcut for bind('ready',fn)\n\t\t\t\tready: function (fn) {\n\n\t\t\t\t\tif (isFunction(fn)) {\n\t\t\t\t\t\t// call function if already ready already\n\t\t\t\t\t\tif (simpleCart.isReady) {\n\t\t\t\t\t\t\tfn.call(simpleCart);\n\n\t\t\t\t\t\t// bind if not ready\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsimpleCart.bind('ready', fn);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t// trigger ready event\n\t\t\t\t\t} else if (isUndefined(fn) && !simpleCart.isReady) {\n\t\t\t\t\t\tsimpleCart.trigger('ready');\n\t\t\t\t\t\tsimpleCart.isReady = true;\n\t\t\t\t\t}\n\n\t\t\t\t},\n\n\n\t\t\t\terror: function (message) {\n\t\t\t\t\tvar msg = \"\";\n\t\t\t\t\tif (isString(message)) {\n\t\t\t\t\t\tmsg = message;\n\t\t\t\t\t} else if (isObject(message) && isString(message.message)) {\n\t\t\t\t\t\tmsg = message.message;\n\t\t\t\t\t}\n\t\t\t\t\ttry { console.log(\"simpleCart(js) Error: \" + msg); } catch (e) {}\n\t\t\t\t\tsimpleCart.trigger('error', [message]);\n\t\t\t\t}\n\t\t\t});\n\n\n\t\t\t/*******************************************************************\n\t\t\t *\tTAX AND SHIPPING\n\t\t\t *******************************************************************/\n\t\t\tsimpleCart.extend({\n\n\t\t\t\t// TODO: tax and shipping\n\t\t\t\ttax: function () {\n\t\t\t\t\tvar totalToTax = settings.taxShipping ? simpleCart.total() + simpleCart.shipping() : simpleCart.total(),\n\t\t\t\t\t\tcost = simpleCart.taxRate() * totalToTax;\n\t\t\t\t\t\n\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\tif (item.get('tax')) {\n\t\t\t\t\t\t\tcost += item.get('tax');\n\t\t\t\t\t\t} else if (item.get('taxRate')) {\n\t\t\t\t\t\t\tcost += item.get('taxRate') * item.total();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn parseFloat(cost);\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\ttaxRate: function () {\n\t\t\t\t\treturn settings.taxRate || 0;\n\t\t\t\t},\n\n\t\t\t\tshipping: function (opt_custom_function) {\n\n\t\t\t\t\t// shortcut to extend options with custom shipping\n\t\t\t\t\tif (isFunction(opt_custom_function)) {\n\t\t\t\t\t\tsimpleCart({\n\t\t\t\t\t\t\tshippingCustom: opt_custom_function\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar cost = settings.shippingQuantityRate * simpleCart.quantity() +\n\t\t\t\t\t\t\tsettings.shippingTotalRate * simpleCart.total() +\n\t\t\t\t\t\t\tsettings.shippingFlatRate;\n\n\t\t\t\t\tif (isFunction(settings.shippingCustom)) {\n\t\t\t\t\t\tcost += settings.shippingCustom.call(simpleCart);\n\t\t\t\t\t}\n\n\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\tcost += parseFloat(item.get('shipping') || 0);\n\t\t\t\t\t});\n\t\t\t\t\treturn parseFloat(cost);\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\t/*******************************************************************\n\t\t\t *\tCART VIEWS\n\t\t\t *******************************************************************/\n\n\t\t\t// built in cart views for item cells\n\t\t\tcartColumnViews = {\n\t\t\t\tattr: function (item, column) {\n\t\t\t\t\treturn item.get(column.attr) || \"\";\n\t\t\t\t},\n\n\t\t\t\tcurrency: function (item, column) {\n\t\t\t\t\treturn simpleCart.toCurrency(item.get(column.attr) || 0);\n\t\t\t\t},\n\n\t\t\t\tlink: function (item, column) {\n\t\t\t\t\treturn \"<a href='\" + item.get(column.attr) + \"'>\" + column.text + \"</a>\";\n\t\t\t\t},\n\n\t\t\t\tdecrement: function (item, column) {\n\t\t\t\t\treturn \"<a href='javascript:;' class='\" + namespace + \"_decrement'>\" + (column.text || \"-\") + \"</a>\";\n\t\t\t\t},\n\n\t\t\t\tincrement: function (item, column) {\n\t\t\t\t\treturn \"<a href='javascript:;' class='\" + namespace + \"_increment'>\" + (column.text || \"+\") + \"</a>\";\n\t\t\t\t},\n\n\t\t\t\timage: function (item, column) {\n\t\t\t\t\treturn \"<img src='\" + item.get(column.attr) + \"'/>\";\n\t\t\t\t},\n\n\t\t\t\tinput: function (item, column) {\n\t\t\t\t\treturn \"<input type='text' value='\" + item.get(column.attr) + \"' class='\" + namespace + \"_input'/>\";\n\t\t\t\t},\n\n\t\t\t\tremove: function (item, column) {\n\t\t\t\t\treturn \"<a href='javascript:;' class='\" + namespace + \"_remove'>\" + (column.text || \"X\") + \"</a>\";\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// cart column wrapper class and functions\n\t\t\tfunction cartColumn(opts) {\n\t\t\t\tvar options = opts || {};\n\t\t\t\treturn simpleCart.extend({\n\t\t\t\t\tattr\t\t\t: \"\",\n\t\t\t\t\tlabel\t\t\t: \"\",\n\t\t\t\t\tview\t\t\t: \"attr\",\n\t\t\t\t\ttext\t\t\t: \"\",\n\t\t\t\t\tclassName\t\t: \"\",\n\t\t\t\t\thide\t\t\t: false\n\t\t\t\t}, options);\n\t\t\t}\n\n\t\t\tfunction cartCellView(item, column) {\n\t\t\t\tvar viewFunc = isFunction(column.view) ? column.view : isString(column.view) && isFunction(cartColumnViews[column.view]) ? cartColumnViews[column.view] : cartColumnViews.attr;\n\n\t\t\t\treturn viewFunc.call(simpleCart, item, column);\n\t\t\t}\n\n\n\t\t\tsimpleCart.extend({\n\n\t\t\t\t// write out cart\n\t\t\t\twriteCart: function (selector) {\n\t\t\t\t\tvar TABLE = settings.cartStyle.toLowerCase(),\n\t\t\t\t\t\tisTable = TABLE === 'table',\n\t\t\t\t\t\tTR = isTable ? \"tr\" : \"div\",\n\t\t\t\t\t\tTH = isTable ? 'th' : 'div',\n\t\t\t\t\t\tTD = isTable ? 'td' : 'div',\n\t\t\t\t\t\tTHEAD = isTable ? 'thead' : 'div',\n\t\t\t\t\t\tcart_container = simpleCart.$create(TABLE),\n\t\t\t\t\t\tthead_container = simpleCart.$create(THEAD),\n\t\t\t\t\t\theader_container = simpleCart.$create(TR).addClass('headerRow'),\n\t\t\t\t\t\tcontainer = simpleCart.$(selector),\n\t\t\t\t\t\tcolumn,\n\t\t\t\t\t\tklass,\n\t\t\t\t\t\tlabel,\n\t\t\t\t\t\tx,\n\t\t\t\t\t\txlen;\n\n\t\t\t\t\tcontainer.html(' ').append(cart_container);\n\n\t\t\t\t\tcart_container.append(thead_container);\n\n\t\t\t\t\tthead_container.append(header_container);\n\n\n\t\t\t\t\t// create header\n\t\t\t\t\tfor (x = 0, xlen = settings.cartColumns.length; x < xlen; x += 1) {\n\t\t\t\t\t\tcolumn\t= cartColumn(settings.cartColumns[x]);\n\t\t\t\t\t\tklass\t=  \"item-\" + (column.attr || column.view || column.label || column.text || \"cell\") + \" \" + column.className;\n\t\t\t\t\t\tlabel\t= column.label || \"\";\n\n\t\t\t\t\t\t// append the header cell\n\t\t\t\t\t\theader_container.append(\n\t\t\t\t\t\t\tsimpleCart.$create(TH).addClass(klass).html(label)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// cycle through the items\n\t\t\t\t\tsimpleCart.each(function (item, y) {\n\t\t\t\t\t\tsimpleCart.createCartRow(item, y, TR, TD, cart_container);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn cart_container;\n\t\t\t\t},\n\n\t\t\t\t// generate a cart row from an item\n\t\t\t\tcreateCartRow: function (item, y, TR, TD, container) {\n\t\t\t\t\tvar row = simpleCart.$create(TR)\n\t\t\t\t\t\t\t\t\t\t.addClass('itemRow row-' + y + \" \" + (y % 2 ? \"even\" : \"odd\"))\n\t\t\t\t\t\t\t\t\t\t.attr('id', \"cartItem_\" + item.id()),\n\t\t\t\t\t\tj,\n\t\t\t\t\t\tjlen,\n\t\t\t\t\t\tcolumn,\n\t\t\t\t\t\tklass,\n\t\t\t\t\t\tcontent,\n\t\t\t\t\t\tcell;\n\n\t\t\t\t\tcontainer.append(row);\n\n\t\t\t\t\t// cycle through the columns to create each cell for the item\n\t\t\t\t\tfor (j = 0, jlen = settings.cartColumns.length; j < jlen; j += 1) {\n\t\t\t\t\t\tcolumn\t= cartColumn(settings.cartColumns[j]);\n\t\t\t\t\t\tklass\t= \"item-\" + (column.attr || (isString(column.view) ? column.view : column.label || column.text || \"cell\")) + \" \" + column.className;\n\t\t\t\t\t\tcontent = cartCellView(item, column);\n\t\t\t\t\t\tcell\t= simpleCart.$create(TD).addClass(klass).html(content);\n\n\t\t\t\t\t\trow.append(cell);\n\t\t\t\t\t}\n\t\t\t\t\treturn row;\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\t/*******************************************************************\n\t\t\t *\tCART ITEM CLASS MANAGEMENT\n\t\t\t *******************************************************************/\n\n\t\t\tsimpleCart.Item = function (info) {\n\n\t\t\t\t// we use the data object to track values for the item\n\t\t\t\tvar _data = {},\n\t\t\t\t\tme = this;\n\n\t\t\t\t// cycle through given attributes and set them to the data object\n\t\t\t\tif (isObject(info)) {\n\t\t\t\t\tsimpleCart.extend(_data, info);\n\t\t\t\t}\n\n\t\t\t\t// set the item id\n\t\t\t\titem_id += 1;\n\t\t\t\t_data.id = _data.id || item_id_namespace + item_id;\n\t\t\t\twhile (!isUndefined(sc_items[_data.id])) {\n\t\t\t\t\titem_id += 1;\n\t\t\t\t\t_data.id = item_id_namespace + item_id;\n\t\t\t\t}\n\n\t\t\t\tfunction checkQuantityAndPrice() {\n\n\t\t\t\t\t// check to make sure price is valid\n\t\t\t\t\tif (isString(_data.price)) {\n\t\t\t\t\t   // trying to remove all chars that aren't numbers or '.'\n\t\t\t\t\t\t_data.price = parseFloat(_data.price.replace(simpleCart.currency().decimal, \".\").replace(/[^0-9\\.]+/ig, \"\"));\n\n\t\t\t\t\t}\n\t\t\t\t\tif (isNaN(_data.price)) {\n\t\t\t\t\t\t_data.price = 0;\n\t\t\t\t\t}\n\t\t\t\t\tif (_data.price < 0) {\n\t\t\t\t\t\t_data.price = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\t// check to make sure quantity is valid\n\t\t\t\t\tif (isString(_data.quantity)) {\n\t\t\t\t\t\t_data.quantity = parseInt(_data.quantity.replace(simpleCart.currency().delimiter, \"\"), 10);\n\t\t\t\t\t}\n\t\t\t\t\tif (isNaN(_data.quantity)) {\n\t\t\t\t\t\t_data.quantity = 1;\n\t\t\t\t\t}\n\t\t\t\t\tif (_data.quantity <= 0) {\n\t\t\t\t\t\tme.remove();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// getter and setter methods to access private variables\n\t\t\t\tme.get = function (name, skipPrototypes) {\n\n\t\t\t\t\tvar usePrototypes = !skipPrototypes;\n\n\t\t\t\t\tif (isUndefined(name)) {\n\t\t\t\t\t\treturn name;\n\t\t\t\t\t}\n\n\t\t\t\t\t// return the value in order of the data object and then the prototype\n\t\t\t\t\treturn isFunction(_data[name])\t? _data[name].call(me) :\n\t\t\t\t\t\t\t!isUndefined(_data[name]) ? _data[name] :\n\n\t\t\t\t\t\t\tisFunction(me[name]) && usePrototypes\t\t? me[name].call(me) :\n\t\t\t\t\t\t\t!isUndefined(me[name]) && usePrototypes\t? me[name] :\n\t\t\t\t\t\t\t_data[name];\n\t\t\t\t};\n\t\t\t\tme.set = function (name, value) {\n\t\t\t\t\tif (!isUndefined(name)) {\n\t\t\t\t\t\t_data[name.toLowerCase()] = value;\n\t\t\t\t\t\tif (name.toLowerCase() === 'price' || name.toLowerCase() === 'quantity') {\n\t\t\t\t\t\t\tcheckQuantityAndPrice();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn me;\n\t\t\t\t};\n\t\t\t\tme.equals = function (item) {\n\t\t\t\t\tfor( var label in _data ){\n\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(_data, label)) {\n\t\t\t\t\t\t\tif (label !== 'quantity' && label !== 'id') {\n\t\t\t\t\t\t\t\tif (item.get(label) !== _data[label]) {\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t};\n\t\t\t\tme.options = function () {\n\t\t\t\t\tvar data = {};\n\t\t\t\t\tsimpleCart.each(_data,function (val, x, label) {\n\t\t\t\t\t\tvar add = true;\n\t\t\t\t\t\tsimpleCart.each(me.reservedFields(), function (field) {\n\t\t\t\t\t\t\tif (field === label) {\n\t\t\t\t\t\t\t\tadd = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn add;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (add) {\n\t\t\t\t\t\t\tdata[label] = me.get(label);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn data;\n\t\t\t\t};\n\n\n\t\t\t\tcheckQuantityAndPrice();\n\t\t\t};\n\n\t\t\tsimpleCart.Item._ = simpleCart.Item.prototype = {\n\n\t\t\t\t// editing the item quantity\n\t\t\t\tincrement: function (amount) {\n\t\t\t\t\tvar diff = amount || 1;\n\t\t\t\t\tdiff = parseInt(diff, 10);\n\n\t\t\t\t\tthis.quantity(this.quantity() + diff);\n\t\t\t\t\tif (this.quantity() < 1) {\n\t\t\t\t\t\tthis.remove();\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\n\t\t\t\t},\n\t\t\t\tdecrement: function (amount) {\n\t\t\t\t\tvar diff = amount || 1;\n\t\t\t\t\treturn this.increment(-parseInt(diff, 10));\n\t\t\t\t},\n\t\t\t\tremove: function (skipUpdate) {\n\t\t\t\t\tvar removeItemBool = simpleCart.trigger(\"beforeRemove\", [sc_items[this.id()]]);\n\t\t\t\t\tif (removeItemBool === false ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tdelete sc_items[this.id()];\n\t\t\t\t\tif (!skipUpdate) { \n\t\t\t\t\t\tsimpleCart.update();\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t},\n\n\t\t\t\t// special fields for items\n\t\t\t\treservedFields: function () {\n\t\t\t\t\treturn ['quantity', 'id', 'item_number', 'price', 'name', 'shipping', 'tax', 'taxRate'];\n\t\t\t\t},\n\n\t\t\t\t// return values for all reserved fields if they exist\n\t\t\t\tfields: function () {\n\t\t\t\t\tvar data = {},\n\t\t\t\t\t\tme = this;\n\t\t\t\t\tsimpleCart.each(me.reservedFields(), function (field) {\n\t\t\t\t\t\tif (me.get(field)) {\n\t\t\t\t\t\t\tdata[field] = me.get(field);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn data;\n\t\t\t\t},\n\n\n\t\t\t\t// shortcuts for getter/setters. can\n\t\t\t\t// be overwritten for customization\n\t\t\t\t// btw, we are hiring at wojo design, and could\n\t\t\t\t// use a great web designer. if thats you, you can\n\t\t\t\t// get more info at http://wojodesign.com/now-hiring/\n\t\t\t\t// or email me directly: brett@wojodesign.com\n\t\t\t\tquantity: function (val) {\n\t\t\t\t\treturn isUndefined(val) ? parseInt(this.get(\"quantity\", true) || 1, 10) : this.set(\"quantity\", val);\n\t\t\t\t},\n\t\t\t\tprice: function (val) {\n\t\t\t\t\treturn isUndefined(val) ?\n\t\t\t\t\t\t\tparseFloat((this.get(\"price\",true).toString()).replace(simpleCart.currency().symbol,\"\").replace(simpleCart.currency().delimiter,\"\") || 1) :\n\t\t\t\t\t\t\tthis.set(\"price\", parseFloat((val).toString().replace(simpleCart.currency().symbol,\"\").replace(simpleCart.currency().delimiter,\"\")));\n\t\t\t\t},\n\t\t\t\tid: function () {\n\t\t\t\t\treturn this.get('id',false);\n\t\t\t\t},\n\t\t\t\ttotal:function () {\n\t\t\t\t\treturn this.quantity()*this.price();\n\t\t\t\t}\n\n\t\t\t};\n\n\n\n\n\t\t\t/*******************************************************************\n\t\t\t *\tCHECKOUT MANAGEMENT\n\t\t\t *******************************************************************/\n\n\t\t\tsimpleCart.extend({\n\t\t\t\tcheckout: function () {\n\t\t\t\t\tif (settings.checkout.type.toLowerCase() === 'custom' && isFunction(settings.checkout.fn)) {\n\t\t\t\t\t\tsettings.checkout.fn.call(simpleCart,settings.checkout);\n\t\t\t\t\t} else if (isFunction(simpleCart.checkout[settings.checkout.type])) {\n\t\t\t\t\t\tvar checkoutData = simpleCart.checkout[settings.checkout.type].call(simpleCart,settings.checkout);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// if the checkout method returns data, try to send the form\n\t\t\t\t\t\tif( checkoutData.data && checkoutData.action && checkoutData.method ){\n\t\t\t\t\t\t\t// if no one has any objections, send the checkout form\n\t\t\t\t\t\t\tif( false !== simpleCart.trigger('beforeCheckout', [checkoutData.data]) ){\n\t\t\t\t\t\t\t\tsimpleCart.generateAndSendForm( checkoutData );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsimpleCart.error(\"No Valid Checkout Method Specified\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\textendCheckout: function (methods) {\n\t\t\t\t\treturn simpleCart.extend(simpleCart.checkout, methods);\n\t\t\t\t},\n\t\t\t\tgenerateAndSendForm: function (opts) {\n\t\t\t\t\tvar form = simpleCart.$create(\"form\");\n\t\t\t\t\tform.attr('style', 'display:none;');\n\t\t\t\t\tform.attr('action', opts.action);\n\t\t\t\t\tform.attr('method', opts.method);\n\t\t\t\t\tsimpleCart.each(opts.data, function (val, x, name) {\n\t\t\t\t\t\tform.append(\n\t\t\t\t\t\t\tsimpleCart.$create(\"input\").attr(\"type\",\"hidden\").attr(\"name\",name).val(val)\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t\tsimpleCart.$(\"body\").append(form);\n\t\t\t\t\tform.el.submit();\n\t\t\t\t\tform.remove();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsimpleCart.extendCheckout({\n\t\t\t\tPayPal: function (opts) {\n\t\t\t\t\t// account email is required\n\t\t\t\t\tif (!opts.email) {\n\t\t\t\t\t\treturn simpleCart.error(\"No email provided for PayPal checkout\");\n\t\t\t\t\t}\n\n\t\t\t\t\t// build basic form options\n\t\t\t\t\tvar data = {\n\t\t\t\t\t\t\t  cmd\t\t\t: \"_cart\"\n\t\t\t\t\t\t\t, upload\t\t: \"1\"\n\t\t\t\t\t\t\t, currency_code : simpleCart.currency().code\n\t\t\t\t\t\t\t, business\t\t: opts.email\n\t\t\t\t\t\t\t, rm\t\t\t: opts.method === \"GET\" ? \"0\" : \"2\"\n\t\t\t\t\t\t\t, tax_cart\t\t: (simpleCart.tax()*1).toFixed(2)\n\t\t\t\t\t\t\t, handling_cart : (simpleCart.shipping()*1).toFixed(2)\n\t\t\t\t\t\t\t, charset\t\t: \"utf-8\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\taction = opts.sandbox ? \"https://www.sandbox.paypal.com/cgi-bin/webscr\" : \"https://www.paypal.com/cgi-bin/webscr\",\n\t\t\t\t\t\tmethod = opts.method === \"GET\" ? \"GET\" : \"POST\";\n\n\n\t\t\t\t\t// check for return and success URLs in the options\n\t\t\t\t\tif (opts.success) {\n\t\t\t\t\t\tdata['return'] = opts.success;\n\t\t\t\t\t}\n\t\t\t\t\tif (opts.cancel) {\n\t\t\t\t\t\tdata.cancel_return = opts.cancel;\n\t\t\t\t\t}\n\t\t\t\t\tif (opts.notify) {\n\t\t\t\t\t\tdata.notify_url = opts.notify;\n\t\t\t\t\t}\n\n\n\t\t\t\t\t// add all the items to the form data\n\t\t\t\t\tsimpleCart.each(function (item,x) {\n\t\t\t\t\t\tvar counter = x+1,\n\t\t\t\t\t\t\titem_options = item.options(),\n\t\t\t\t\t\t\toptionCount = 0,\n\t\t\t\t\t\t\tsend;\n\t\n\t\t\t\t\t\t// basic item data\n\t\t\t\t\t\tdata[\"item_name_\" + counter] = item.get(\"name\");\n\t\t\t\t\t\tdata[\"quantity_\" + counter] = item.quantity();\n\t\t\t\t\t\tdata[\"amount_\" + counter] = (item.price()*1).toFixed(2);\n\t\t\t\t\t\tdata[\"item_number_\" + counter] = item.get(\"item_number\") || counter;\n\n\n\t\t\t\t\t\t// add the options\n\t\t\t\t\t\tsimpleCart.each(item_options, function (val,k,attr) {\n\t\t\t\t\t\t\t// paypal limits us to 10 options\n\t\t\t\t\t\t\tif (k < 10) {\n\t\t\n\t\t\t\t\t\t\t\t// check to see if we need to exclude this from checkout\n\t\t\t\t\t\t\t\tsend = true;\n\t\t\t\t\t\t\t\tsimpleCart.each(settings.excludeFromCheckout, function (field_name) {\n\t\t\t\t\t\t\t\t\tif (field_name === attr) { send = false; }\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tif (send) {\n\t\t\t\t\t\t\t\t\t\toptionCount += 1;\n\t\t\t\t\t\t\t\t\t\tdata[\"on\" + k + \"_\" + counter] = attr;\n\t\t\t\t\t\t\t\t\t\tdata[\"os\" + k + \"_\" + counter] = val;\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// options count\n\t\t\t\t\t\tdata[\"option_index_\"+ x] = Math.min(10, optionCount);\n\t\t\t\t\t});\n\n\n\t\t\t\t\t// return the data for the checkout form\n\t\t\t\t\treturn {\n\t\t\t\t\t\t  action\t: action\n\t\t\t\t\t\t, method\t: method\n\t\t\t\t\t\t, data\t\t: data\n\t\t\t\t\t};\n\n\t\t\t\t},\n\n\n\t\t\t\tGoogleCheckout: function (opts) {\n\t\t\t\t\t// account id is required\n\t\t\t\t\tif (!opts.merchantID) {\n\t\t\t\t\t\treturn simpleCart.error(\"No merchant id provided for GoogleCheckout\");\n\t\t\t\t\t}\n\n\t\t\t\t\t// google only accepts USD and GBP\n\t\t\t\t\tif (simpleCart.currency().code !== \"USD\" && simpleCart.currency().code !== \"GBP\") {\n\t\t\t\t\t\treturn simpleCart.error(\"Google Checkout only accepts USD and GBP\");\n\t\t\t\t\t}\n\n\t\t\t\t\t// build basic form options\n\t\t\t\t\tvar data = {\n\t\t\t\t\t\t\t// TODO: better shipping support for this google\n\t\t\t\t\t\t\t  ship_method_name_1\t: \"Shipping\"\n\t\t\t\t\t\t\t, ship_method_price_1\t: simpleCart.shipping()\n\t\t\t\t\t\t\t, ship_method_currency_1: simpleCart.currency().code\n\t\t\t\t\t\t\t, _charset_\t\t\t\t: ''\n\t\t\t\t\t\t},\n\t\t\t\t\t\taction = \"https://checkout.google.com/api/checkout/v2/checkoutForm/Merchant/\" + opts.merchantID,\n\t\t\t\t\t\tmethod = opts.method === \"GET\" ? \"GET\" : \"POST\";\n\n\n\t\t\t\t\t// add items to data\n\t\t\t\t\tsimpleCart.each(function (item,x) {\n\t\t\t\t\t\tvar counter = x+1,\n\t\t\t\t\t\t\toptions_list = [],\n\t\t\t\t\t\t\tsend;\n\t\t\t\t\t\tdata['item_name_' + counter]\t\t= item.get('name');\n\t\t\t\t\t\tdata['item_quantity_' + counter]\t= item.quantity();\n\t\t\t\t\t\tdata['item_price_' + counter]\t\t= item.price();\n\t\t\t\t\t\tdata['item_currency_ ' + counter]\t= simpleCart.currency().code;\n\t\t\t\t\t\tdata['item_tax_rate' + counter]\t\t= item.get('taxRate') || simpleCart.taxRate();\n\n\t\t\t\t\t\t// create array of extra options\n\t\t\t\t\t\tsimpleCart.each(item.options(), function (val,x,attr) {\n\t\t\t\t\t\t\t// check to see if we need to exclude this from checkout\n\t\t\t\t\t\t\tsend = true;\n\t\t\t\t\t\t\tsimpleCart.each(settings.excludeFromCheckout, function (field_name) {\n\t\t\t\t\t\t\t\tif (field_name === attr) { send = false; }\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (send) {\n\t\t\t\t\t\t\t\toptions_list.push(attr + \": \" + val);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// add the options to the description\n\t\t\t\t\t\tdata['item_description_' + counter] = options_list.join(\", \");\n\t\t\t\t\t});\n\n\t\t\t\t\t// return the data for the checkout form\n\t\t\t\t\treturn {\n\t\t\t\t\t\t  action\t: action\n\t\t\t\t\t\t, method\t: method\n\t\t\t\t\t\t, data\t\t: data\n\t\t\t\t\t};\n\n\n\t\t\t\t},\n\n\n\t\t\t\tAmazonPayments: function (opts) {\n\t\t\t\t\t// required options\n\t\t\t\t\tif (!opts.merchant_signature) {\n\t\t\t\t\t\treturn simpleCart.error(\"No merchant signature provided for Amazon Payments\");\n\t\t\t\t\t}\n\t\t\t\t\tif (!opts.merchant_id) {\n\t\t\t\t\t\treturn simpleCart.error(\"No merchant id provided for Amazon Payments\");\n\t\t\t\t\t}\n\t\t\t\t\tif (!opts.aws_access_key_id) {\n\t\t\t\t\t\treturn simpleCart.error(\"No AWS access key id provided for Amazon Payments\");\n\t\t\t\t\t}\n\n\n\t\t\t\t\t// build basic form options\n\t\t\t\t\tvar data = {\n\t\t\t\t\t\t\t  aws_access_key_id:\topts.aws_access_key_id\n\t\t\t\t\t\t\t, merchant_signature:\topts.merchant_signature\n\t\t\t\t\t\t\t, currency_code:\t\tsimpleCart.currency().code\n\t\t\t\t\t\t\t, tax_rate:\t\t\t\tsimpleCart.taxRate()\n\t\t\t\t\t\t\t, weight_unit:\t\t\topts.weight_unit || 'lb'\n\t\t\t\t\t\t},\n\t\t\t\t\t\taction = \"https://payments\" + (opts.sandbox ? \"-sandbox\" : \"\") + \".amazon.com/checkout/\" + opts.merchant_id,\n\t\t\t\t\t\tmethod = opts.method === \"GET\" ? \"GET\" : \"POST\";\n\n\n\t\t\t\t\t// add items to data\n\t\t\t\t\tsimpleCart.each(function (item,x) {\n\t\t\t\t\t\tvar counter = x+1,\n\t\t\t\t\t\t\toptions_list = [];\n\t\t\t\t\t\tdata['item_title_' + counter]\t\t\t= item.get('name');\n\t\t\t\t\t\tdata['item_quantity_' + counter]\t\t= item.quantity();\n\t\t\t\t\t\tdata['item_price_' + counter]\t\t\t= item.price();\n\t\t\t\t\t\tdata['item_sku_ ' + counter]\t\t\t= item.get('sku') || item.id();\n\t\t\t\t\t\tdata['item_merchant_id_' + counter]\t= opts.merchant_id;\n\t\t\t\t\t\tif (item.get('weight')) {\n\t\t\t\t\t\t\tdata['item_weight_' + counter]\t\t= item.get('weight');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (settings.shippingQuantityRate) {\n\t\t\t\t\t\t\tdata['shipping_method_price_per_unit_rate_' + counter] = settings.shippingQuantityRate;\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t// create array of extra options\n\t\t\t\t\t\tsimpleCart.each(item.options(), function (val,x,attr) {\n\t\t\t\t\t\t\t// check to see if we need to exclude this from checkout\n\t\t\t\t\t\t\tvar send = true;\n\t\t\t\t\t\t\tsimpleCart.each(settings.excludeFromCheckout, function (field_name) {\n\t\t\t\t\t\t\t\tif (field_name === attr) { send = false; }\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (send && attr !== 'weight' && attr !== 'tax') {\n\t\t\t\t\t\t\t\toptions_list.push(attr + \": \" + val);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// add the options to the description\n\t\t\t\t\t\tdata['item_description_' + counter] = options_list.join(\", \");\n\t\t\t\t\t});\n\n\t\t\t\t\t// return the data for the checkout form\n\t\t\t\t\treturn {\n\t\t\t\t\t\t  action\t: action\n\t\t\t\t\t\t, method\t: method\n\t\t\t\t\t\t, data\t\t: data\n\t\t\t\t\t};\n\n\t\t\t\t},\n\n\n\t\t\t\tSendForm: function (opts) {\n\t\t\t\t\t// url required\n\t\t\t\t\tif (!opts.url) {\n\t\t\t\t\t\treturn simpleCart.error('URL required for SendForm Checkout');\n\t\t\t\t\t}\n\n\t\t\t\t\t// build basic form options\n\t\t\t\t\tvar data = {\n\t\t\t\t\t\t\t  currency\t: simpleCart.currency().code\n\t\t\t\t\t\t\t, shipping\t: simpleCart.shipping()\n\t\t\t\t\t\t\t, tax\t\t: simpleCart.tax()\n\t\t\t\t\t\t\t, taxRate\t: simpleCart.taxRate()\n\t\t\t\t\t\t\t, itemCount : simpleCart.find({}).length\n\t\t\t\t\t\t},\n\t\t\t\t\t\taction = opts.url,\n\t\t\t\t\t\tmethod = opts.method === \"GET\" ? \"GET\" : \"POST\";\n\n\n\t\t\t\t\t// add items to data\n\t\t\t\t\tsimpleCart.each(function (item,x) {\n\t\t\t\t\t\tvar counter = x+1,\n\t\t\t\t\t\t\toptions_list = [],\n\t\t\t\t\t\t\tsend;\n\t\t\t\t\t\tdata['item_name_' + counter]\t\t= item.get('name');\n\t\t\t\t\t\tdata['item_quantity_' + counter]\t= item.quantity();\n\t\t\t\t\t\tdata['item_price_' + counter]\t\t= item.price();\n\n\t\t\t\t\t\t// create array of extra options\n\t\t\t\t\t\tsimpleCart.each(item.options(), function (val,x,attr) {\n\t\t\t\t\t\t\t// check to see if we need to exclude this from checkout\n\t\t\t\t\t\t\tsend = true;\n\t\t\t\t\t\t\tsimpleCart.each(settings.excludeFromCheckout, function (field_name) {\n\t\t\t\t\t\t\t\tif (field_name === attr) { send = false; }\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (send) {\n\t\t\t\t\t\t\t\toptions_list.push(attr + \": \" + val);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// add the options to the description\n\t\t\t\t\t\tdata['item_options_' + counter] = options_list.join(\", \");\n\t\t\t\t\t});\n\n\n\t\t\t\t\t// check for return and success URLs in the options\n\t\t\t\t\tif (opts.success) {\n\t\t\t\t\t\tdata['return'] = opts.success;\n\t\t\t\t\t}\n\t\t\t\t\tif (opts.cancel) {\n\t\t\t\t\t\tdata.cancel_return = opts.cancel;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (opts.extra_data) {\n\t\t\t\t\t\tdata = simpleCart.extend(data,opts.extra_data);\n\t\t\t\t\t}\n\n\t\t\t\t\t// return the data for the checkout form\n\t\t\t\t\treturn {\n\t\t\t\t\t\t  action\t: action\n\t\t\t\t\t\t, method\t: method\n\t\t\t\t\t\t, data\t\t: data\n\t\t\t\t\t};\n\t\t\t\t}\n\n\n\t\t\t});\n\n\n\t\t\t/*******************************************************************\n\t\t\t *\tEVENT MANAGEMENT\n\t\t\t *******************************************************************/\n\t\t\teventFunctions = {\n\n\t\t\t\t// bind a callback to an event\n\t\t\t\tbind: function (name, callback) {\n\t\t\t\t\tif (!isFunction(callback)) {\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this._events) {\n\t\t\t\t\t\tthis._events = {};\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// split by spaces to allow for multiple event bindings at once\n\t\t\t\t\tvar eventNameList = name.split(/ +/);\n\t\t\t\t\t\n\t\t\t\t\t// iterate through and bind each event\n\t\t\t\t\tsimpleCart.each( eventNameList , function( eventName ){\n\t\t\t\t\t\tif (this._events[eventName] === true) {\n\t\t\t\t\t\t\tcallback.apply(this);\n\t\t\t\t\t\t} else if (!isUndefined(this._events[eventName])) {\n\t\t\t\t\t\t\tthis._events[eventName].push(callback);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._events[eventName] = [callback];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\t// trigger event\n\t\t\t\ttrigger: function (name, options) {\n\t\t\t\t\tvar returnval = true,\n\t\t\t\t\t\tx,\n\t\t\t\t\t\txlen;\n\n\t\t\t\t\tif (!this._events) {\n\t\t\t\t\t\tthis._events = {};\n\t\t\t\t\t}\n\t\t\t\t\tif (!isUndefined(this._events[name]) && isFunction(this._events[name][0])) {\n\t\t\t\t\t\tfor (x = 0, xlen = this._events[name].length; x < xlen; x += 1) {\n\t\t\t\t\t\t\treturnval = this._events[name][x].apply(this, (options || []));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (returnval === false) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t};\n\t\t\t// alias for bind\n\t\t\teventFunctions.on = eventFunctions.bind;\n\t\t\tsimpleCart.extend(eventFunctions);\n\t\t\tsimpleCart.extend(simpleCart.Item._, eventFunctions);\n\n\n\t\t\t// base simpleCart events in options\n\t\t\tbaseEvents = {\n\t\t\t\t  beforeAdd\t\t\t\t: null\n\t\t\t\t, afterAdd\t\t\t\t: null\n\t\t\t\t, load\t\t\t\t\t: null\n\t\t\t\t, beforeSave\t\t\t: null\n\t\t\t\t, afterSave\t\t\t\t: null\n\t\t\t\t, update\t\t\t\t: null\n\t\t\t\t, ready\t\t\t\t\t: null\n\t\t\t\t, checkoutSuccess\t\t: null\n\t\t\t\t, checkoutFail\t\t\t: null\n\t\t\t\t, beforeCheckout\t\t: null\n\t\t\t\t, beforeRemove\t\t\t: null\n\t\t\t};\n\t\t\t\n\t\t\t// extend with base events\n\t\t\tsimpleCart(baseEvents);\n\n\t\t\t// bind settings to events\n\t\t\tsimpleCart.each(baseEvents, function (val, x, name) {\n\t\t\t\tsimpleCart.bind(name, function () {\n\t\t\t\t\tif (isFunction(settings[name])) {\n\t\t\t\t\t\tsettings[name].apply(this, arguments);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t/*******************************************************************\n\t\t\t *\tFORMATTING FUNCTIONS\n\t\t\t *******************************************************************/\n\t\t\tsimpleCart.extend({\n\t\t\t\ttoCurrency: function (number,opts) {\n\t\t\t\t\tvar num = parseFloat(number),\n\t\t\t\t\t\topt_input = opts || {},\n\t\t\t\t\t\t_opts = simpleCart.extend(simpleCart.extend({\n\t\t\t\t\t\t\t  symbol:\t\t\"$\"\n\t\t\t\t\t\t\t, decimal:\t\t\".\"\n\t\t\t\t\t\t\t, delimiter:\t\",\"\n\t\t\t\t\t\t\t, accuracy:\t\t2\n\t\t\t\t\t\t\t, after: false\n\t\t\t\t\t\t}, simpleCart.currency()), opt_input),\n\n\t\t\t\t\t\tnumParts = num.toFixed(_opts.accuracy).split(\".\"),\n\t\t\t\t\t\tdec = numParts[1],\n\t\t\t\t\t\tints = numParts[0];\n\t\t\t\n\t\t\t\t\tints = simpleCart.chunk(ints.reverse(), 3).join(_opts.delimiter.reverse()).reverse();\n\n\t\t\t\t\treturn\t(!_opts.after ? _opts.symbol : \"\") +\n\t\t\t\t\t\t\tints +\n\t\t\t\t\t\t\t(dec ? _opts.decimal + dec : \"\") +\n\t\t\t\t\t\t\t(_opts.after ? _opts.symbol : \"\");\n\t\n\t\t\t\t},\n\n\n\t\t\t\t// break a string in blocks of size n\n\t\t\t\tchunk: function (str, n) {\n\t\t\t\t\tif (typeof n==='undefined') {\n\t\t\t\t\t\tn=2;\n\t\t\t\t\t}\n\t\t\t\t\tvar result = str.match(new RegExp('.{1,' + n + '}','g'));\n\t\t\t\t\treturn result || [];\n\t\t\t\t}\n\n\t\t\t});\n\n\n\t\t\t// reverse string function\n\t\t\tString.prototype.reverse = function () {\n\t\t\t\treturn this.split(\"\").reverse().join(\"\");\n\t\t\t};\n\n\n\t\t\t// currency functions\n\t\t\tsimpleCart.extend({\n\t\t\t\tcurrency: function (currency) {\n\t\t\t\t\tif (isString(currency) && !isUndefined(currencies[currency])) {\n\t\t\t\t\t\tsettings.currency = currency;\n\t\t\t\t\t} else if (isObject(currency)) {\n\t\t\t\t\t\tcurrencies[currency.code] = currency;\n\t\t\t\t\t\tsettings.currency = currency.code;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn currencies[settings.currency];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\n\t\t\t/*******************************************************************\n\t\t\t *\tVIEW MANAGEMENT\n\t\t\t *******************************************************************/\n\n\t\t\tsimpleCart.extend({\n\t\t\t\t// bind outlets to function\n\t\t\t\tbindOutlets: function (outlets) {\n\t\t\t\t\tsimpleCart.each(outlets, function (callback, x, selector) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tsimpleCart.bind('update', function () {\n\t\t\t\t\t\t\tsimpleCart.setOutlet(\".\" + namespace + \"_\" + selector, callback);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\t// set function return to outlet\n\t\t\t\tsetOutlet: function (selector, func) {\n\t\t\t\t\tvar val = func.call(simpleCart, selector);\n\t\t\t\t\tif (isObject(val) && val.el) {\n\t\t\t\t\t\tsimpleCart.$(selector).html(' ').append(val);\n\t\t\t\t\t} else if (!isUndefined(val)) {\n\t\t\t\t\t\tsimpleCart.$(selector).html(val);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// bind click events on inputs\n\t\t\t\tbindInputs: function (inputs) {\n\t\t\t\t\tsimpleCart.each(inputs, function (info) {\n\t\t\t\t\t\tsimpleCart.setInput(\".\" + namespace + \"_\" + info.selector, info.event, info.callback);\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\t// attach events to inputs\t\n\t\t\t\tsetInput: function (selector, event, func) {\n\t\t\t\t\tsimpleCart.$(selector).live(event, func);\n\t\t\t\t}\n\t\t\t});\t\t\n\n\n\t\t\t// class for wrapping DOM selector shit\n\t\t\tsimpleCart.ELEMENT = function (selector) {\n\n\t\t\t\tthis.create(selector);\n\t\t\t\tthis.selector = selector || null; // \"#\" + this.attr('id'); TODO: test length?\n\t\t\t};\n\n\t\t\tsimpleCart.extend(selectorFunctions, {\n\n\t\t\t\t\"MooTools\"\t\t: {\n\t\t\t\t\ttext: function (text) {\n\t\t\t\t\t\treturn this.attr(_TEXT_, text);\n\t\t\t\t\t},\n\t\t\t\t\thtml: function (html) {\n\t\t\t\t\t\treturn this.attr(_HTML_, html);\n\t\t\t\t\t},\n\t\t\t\t\tval: function (val) {\n\t\t\t\t\t\treturn this.attr(_VALUE_, val);\n\t\t\t\t\t},\n\t\t\t\t\tattr: function (attr, val) {\n\t\t\t\t\t\tif (isUndefined(val)) {\n\t\t\t\t\t\t\treturn this.el[0] && this.el[0].get(attr);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.el.set(attr, val);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tremove: function () {\n\t\t\t\t\t\tthis.el.dispose();\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t},\n\t\t\t\t\taddClass: function (klass) {\n\t\t\t\t\t\tthis.el.addClass(klass);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tremoveClass: function (klass) {\n\t\t\t\t\t\tthis.el.removeClass(klass);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tappend: function (item) {\n\t\t\t\t\t\tthis.el.adopt(item.el);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\teach: function (callback) {\n\t\t\t\t\t\tif (isFunction(callback)) {\n\t\t\t\t\t\t\tsimpleCart.each(this.el, function( e, i, c) {\n\t\t\t\t\t\t\t\tcallback.call( i, i, e, c );\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tclick: function (callback) {\n\t\t\t\t\t\tif (isFunction(callback)) {\n\t\t\t\t\t\t\tthis.each(function (e) {\n\t\t\t\t\t\t\t\te.addEvent(_CLICK_, function (ev) {\n\t\t\t\t\t\t\t\t\tcallback.call(e,ev);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if (isUndefined(callback)) {\n\t\t\t\t\t\t\tthis.el.fireEvent(_CLICK_);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tlive: function (\tevent,callback) {\n\t\t\t\t\t\tvar selector = this.selector;\n\t\t\t\t\t\tif (isFunction(callback)) {\n\t\t\t\t\t\t\tsimpleCart.$(\"body\").el.addEvent(event + \":relay(\" + selector + \")\", function (e, el) {\n\t\t\t\t\t\t\t\tcallback.call(el, e);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tmatch: function (selector) {\n\t\t\t\t\t\treturn this.el.match(selector);\n\t\t\t\t\t},\n\t\t\t\t\tparent: function () {\n\t\t\t\t\t\treturn simpleCart.$(this.el.getParent());\n\t\t\t\t\t},\n\t\t\t\t\tfind: function (selector) {\n\t\t\t\t\t\treturn simpleCart.$(this.el.getElements(selector));\n\t\t\t\t\t},\n\t\t\t\t\tclosest: function (selector) {\n\t\t\t\t\t\treturn simpleCart.$(this.el.getParent(selector));\n\t\t\t\t\t},\n\t\t\t\t\tdescendants: function () {\n\t\t\t\t\t\treturn this.find(\"*\");\n\t\t\t\t\t},\n\t\t\t\t\ttag: function () {\n\t\t\t\t\t\treturn this.el[0].tagName;\n\t\t\t\t\t},\n\t\t\t\t\tsubmit: function (){\n\t\t\t\t\t\tthis.el[0].submit();\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tcreate: function (selector) {\n\t\t\t\t\t\tthis.el = $engine(selector);\n\t\t\t\t\t}\n\n\n\t\t\t\t},\n\n\t\t\t\t\"Prototype\"\t\t: {\n\t\t\t\t\ttext: function (text) {\n\t\t\t\t\t\tif (isUndefined(text)) {\n\t\t\t\t\t\t\treturn this.el[0].innerHTML;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.each(function (i,e) {\n\t\t\t\t\t\t\t$(e).update(text);\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\thtml: function (html) {\n\t\t\t\t\t\treturn this.text(html);\n\t\t\t\t\t},\n\t\t\t\t\tval: function (val) {\n\t\t\t\t\t\treturn this.attr(_VALUE_, val);\n\t\t\t\t\t},\n\t\t\t\t\tattr: function (attr, val) {\n\t\t\t\t\t\tif (isUndefined(val)) {\n\t\t\t\t\t\t\treturn this.el[0].readAttribute(attr);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.each(function (i,e) {\n\t\t\t\t\t\t\t$(e).writeAttribute(attr, val);\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tappend: function (item) {\n\t\t\t\t\t\tthis.each(function (i,e) {\n\t\t\t\t\t\t\tif (item.el) {\n\t\t\t\t\t\t\t\titem.each(function (i2,e2) {\n\t\t\t\t\t\t\t\t\t$(e).appendChild(e2);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else if (isElement(item)) {\n\t\t\t\t\t\t\t\t$(e).appendChild(item);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tremove: function () {\n\t\t\t\t\t\tthis.each(function (i, e) {\n\t\t\t\t\t\t\t$(e).remove();\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\taddClass: function (klass) {\n\t\t\t\t\t\tthis.each(function (i, e) {\n\t\t\t\t\t\t\t$(e).addClassName(klass);\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tremoveClass: function (klass) {\n\t\t\t\t\t\tthis.each(function (i, e) {\n\t\t\t\t\t\t\t$(e).removeClassName(klass);\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\teach: function (callback) {\n\t\t\t\t\t\tif (isFunction(callback)) {\n\t\t\t\t\t\t\tsimpleCart.each(this.el, function( e, i, c) {\n\t\t\t\t\t\t\t\tcallback.call( i, i, e, c );\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tclick: function (callback) {\n\t\t\t\t\t\tif (isFunction(callback)) {\n\t\t\t\t\t\t\tthis.each(function (i, e) {\n\t\t\t\t\t\t\t\t$(e).observe(_CLICK_, function (ev) {\n\t\t\t\t\t\t\t\t\tcallback.call(e,ev);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if (isUndefined(callback)) {\n\t\t\t\t\t\t\tthis.each(function (i, e) {\n\t\t\t\t\t\t\t\t$(e).fire(_CLICK_);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tlive: function (event,callback) {\n\t\t\t\t\t\tif (isFunction(callback)) {\n\t\t\t\t\t\t\tvar selector = this.selector;\n\t\t\t\t\t\t\tdocument.observe(event, function (e, el) {\n\t\t\t\t\t\t\t\tif (el === $engine(e).findElement(selector)) {\n\t\t\t\t\t\t\t\t\tcallback.call(el, e);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tparent: function () {\n\t\t\t\t\t\treturn simpleCart.$(this.el.up());\n\t\t\t\t\t},\n\t\t\t\t\tfind: function (selector) {\n\t\t\t\t\t\treturn simpleCart.$(this.el.getElementsBySelector(selector));\n\t\t\t\t\t},\n\t\t\t\t\tclosest: function (selector) {\n\t\t\t\t\t\treturn simpleCart.$(this.el.up(selector));\n\t\t\t\t\t},\n\t\t\t\t\tdescendants: function () {\n\t\t\t\t\t\treturn simpleCart.$(this.el.descendants());\n\t\t\t\t\t},\n\t\t\t\t\ttag: function () {\n\t\t\t\t\t\treturn this.el.tagName;\n\t\t\t\t\t},\n\t\t\t\t\tsubmit: function() {\n\t\t\t\t\t\tthis.el[0].submit();\n\t\t\t\t\t},\n\n\t\t\t\t\tcreate: function (selector) {\n\t\t\t\t\t\tif (isString(selector)) {\n\t\t\t\t\t\t\tthis.el = $engine(selector);\n\t\t\t\t\t\t} else if (isElement(selector)) {\n\t\t\t\t\t\t\tthis.el = [selector];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\n\n\t\t\t\t},\n\n\t\t\t\t\"jQuery\": {\n\t\t\t\t\tpassthrough: function (action, val) {\n\t\t\t\t\t\tif (isUndefined(val)) {\n\t\t\t\t\t\t\treturn this.el[action]();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.el[action](val);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\ttext: function (text) {\n\t\t\t\t\t\treturn this.passthrough(_TEXT_, text);\n\t\t\t\t\t},\n\t\t\t\t\thtml: function (html) {\n\t\t\t\t\t\treturn this.passthrough(_HTML_, html);\n\t\t\t\t\t},\n\t\t\t\t\tval: function (val) {\n\t\t\t\t\t\treturn this.passthrough(\"val\", val);\n\t\t\t\t\t},\n\t\t\t\t\tappend: function (item) {\n\t\t\t\t\t\tvar target = item.el || item;\n\t\t\t\t\t\tthis.el.append(target);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tattr: function (attr, val) {\n\t\t\t\t\t\tif (isUndefined(val)) {\n\t\t\t\t\t\t\treturn this.el.attr(attr);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.el.attr(attr, val);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tremove: function () {\n\t\t\t\t\t\tthis.el.remove();\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\taddClass: function (klass) {\n\t\t\t\t\t\tthis.el.addClass(klass);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tremoveClass: function (klass) {\n\t\t\t\t\t\tthis.el.removeClass(klass);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\teach: function (callback) {\n\t\t\t\t\t\treturn this.passthrough('each', callback);\n\t\t\t\t\t},\n\t\t\t\t\tclick: function (callback) {\n\t\t\t\t\t\treturn this.passthrough(_CLICK_, callback);\n\t\t\t\t\t},\n\t\t\t\t\tlive: function (event, callback) {\n\t\t\t\t\t\t$engine(document).delegate(this.selector, event, callback);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tparent: function () {\n\t\t\t\t\t\treturn simpleCart.$(this.el.parent());\n\t\t\t\t\t},\n\t\t\t\t\tfind: function (selector) {\n\t\t\t\t\t\treturn simpleCart.$(this.el.find(selector));\n\t\t\t\t\t},\n\t\t\t\t\tclosest: function (selector) {\n\t\t\t\t\t\treturn simpleCart.$(this.el.closest(selector));\n\t\t\t\t\t},\n\t\t\t\t\ttag: function () {\n\t\t\t\t\t\treturn this.el[0].tagName;\n\t\t\t\t\t},\n\t\t\t\t\tdescendants: function () {\n\t\t\t\t\t\treturn simpleCart.$(this.el.find(\"*\"));\n\t\t\t\t\t},\n\t\t\t\t\tsubmit: function() {\n\t\t\t\t\t\treturn this.el.submit();\n\t\t\t\t\t},\n\n\t\t\t\t\tcreate: function (selector) {\n\t\t\t\t\t\tthis.el = $engine(selector);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tsimpleCart.ELEMENT._ = simpleCart.ELEMENT.prototype;\n\n\t\t\t// bind the DOM setup to the ready event\n\t\t\tsimpleCart.ready(simpleCart.setupViewTool);\n\n\t\t\t// bind the input and output events\n\t\t\tsimpleCart.ready(function () {\n\t\t\t\tsimpleCart.bindOutlets({\n\t\t\t\t\ttotal: function () {\n\t\t\t\t\t\treturn simpleCart.toCurrency(simpleCart.total());\n\t\t\t\t\t}\n\t\t\t\t\t, quantity: function () {\n\t\t\t\t\t\treturn simpleCart.quantity();\n\t\t\t\t\t}\n\t\t\t\t\t, items: function (selector) {\n\t\t\t\t\t\tsimpleCart.writeCart(selector);\n\t\t\t\t\t}\n\t\t\t\t\t, tax: function () {\n\t\t\t\t\t\treturn simpleCart.toCurrency(simpleCart.tax());\n\t\t\t\t\t}\n\t\t\t\t\t, taxRate: function () {\n\t\t\t\t\t\treturn simpleCart.taxRate().toFixed();\n\t\t\t\t\t}\n\t\t\t\t\t, shipping: function () {\n\t\t\t\t\t\treturn simpleCart.toCurrency(simpleCart.shipping());\n\t\t\t\t\t}\n\t\t\t\t\t, grandTotal: function () {\n\t\t\t\t\t\treturn simpleCart.toCurrency(simpleCart.grandTotal());\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tsimpleCart.bindInputs([\n\t\t\t\t\t{\t  selector: 'checkout'\n\t\t\t\t\t\t, event: 'click'\n\t\t\t\t\t\t, callback: function () {\n\t\t\t\t\t\t\tsimpleCart.checkout();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t, {\t  selector: 'empty'\n\t\t\t\t\t\t, event: 'click'\n\t\t\t\t\t\t, callback: function () {\n\t\t\t\t\t\t\tsimpleCart.empty();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t, {\t  selector: 'increment'\n\t\t\t\t\t\t, event: 'click'\n\t\t\t\t\t\t, callback: function () {\n\t\t\t\t\t\t\tsimpleCart.find(simpleCart.$(this).closest('.itemRow').attr('id').split(\"_\")[1]).increment();\n\t\t\t\t\t\t\tsimpleCart.update();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t, {\t  selector: 'decrement'\n\t\t\t\t\t\t, event: 'click'\n\t\t\t\t\t\t, callback: function () {\n\t\t\t\t\t\t\tsimpleCart.find(simpleCart.$(this).closest('.itemRow').attr('id').split(\"_\")[1]).decrement();\n\t\t\t\t\t\t\tsimpleCart.update();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t/* remove from cart */\n\t\t\t\t\t, {\t  selector: 'remove'\n\t\t\t\t\t\t, event: 'click'\n\t\t\t\t\t\t, callback: function () {\n\t\t\t\t\t\t\tsimpleCart.find(simpleCart.$(this).closest('.itemRow').attr('id').split(\"_\")[1]).remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t/* cart inputs */\n\t\t\t\t\t, {\t  selector: 'input'\n\t\t\t\t\t\t, event: 'change'\n\t\t\t\t\t\t, callback: function () {\n\t\t\t\t\t\t\tvar $input = simpleCart.$(this),\n\t\t\t\t\t\t\t\t$parent = $input.parent(),\n\t\t\t\t\t\t\t\tclassList = $parent.attr('class').split(\" \");\n\t\t\t\t\t\t\tsimpleCart.each(classList, function (klass) {\n\t\t\t\t\t\t\t\tif (klass.match(/item-.+/i)) {\n\t\t\t\t\t\t\t\t\tvar field = klass.split(\"-\")[1];\n\t\t\t\t\t\t\t\t\tsimpleCart.find($parent.closest('.itemRow').attr('id').split(\"_\")[1]).set(field,$input.val());\n\t\t\t\t\t\t\t\t\tsimpleCart.update();\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t/* here is our shelfItem add to cart button listener */\n\t\t\t\t\t, { selector: 'shelfItem .item_add'\n\t\t\t\t\t\t, event: 'click'\n\t\t\t\t\t\t, callback: function () {\n\t\t\t\t\t\t\tvar $button = simpleCart.$(this),\n\t\t\t\t\t\t\t\tfields = {};\n\n\t\t\t\t\t\t\t$button.closest(\".\" + namespace + \"_shelfItem\").descendants().each(function (x,item) {\n\t\t\t\t\t\t\t\tvar $item = simpleCart.$(item);\n\n\t\t\t\t\t\t\t\t// check to see if the class matches the item_[fieldname] pattern\n\t\t\t\t\t\t\t\tif ($item.attr(\"class\") &&\n\t\t\t\t\t\t\t\t\t$item.attr(\"class\").match(/item_.+/) &&\n\t\t\t\t\t\t\t\t\t!$item.attr('class').match(/item_add/)) {\n\n\t\t\t\t\t\t\t\t\t// find the class name\n\t\t\t\t\t\t\t\t\tsimpleCart.each($item.attr('class').split(' '), function (klass) {\n\t\t\t\t\t\t\t\t\t\tvar attr,\n\t\t\t\t\t\t\t\t\t\t\tval,\n\t\t\t\t\t\t\t\t\t\t\ttype;\n\n\t\t\t\t\t\t\t\t\t\t// get the value or text depending on the tagName\n\t\t\t\t\t\t\t\t\t\tif (klass.match(/item_.+/)) {\n\t\t\t\t\t\t\t\t\t\t\tattr = klass.split(\"_\")[1];\n\t\t\t\t\t\t\t\t\t\t\tval = \"\";\n\t\t\t\t\t\t\t\t\t\t\tswitch($item.tag().toLowerCase()) {\n\t\t\t\t\t\t\t\t\t\t\t\tcase \"input\":\n\t\t\t\t\t\t\t\t\t\t\t\tcase \"textarea\":\n\t\t\t\t\t\t\t\t\t\t\t\tcase \"select\":\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype = $item.attr(\"type\");\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (!type || ((type.toLowerCase() === \"checkbox\" || type.toLowerCase() === \"radio\") && $item.attr(\"checked\")) || type.toLowerCase() === \"text\" || type.toLowerCase() === \"number\") {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tval = $item.val();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\tcase \"img\":\n\t\t\t\t\t\t\t\t\t\t\t\t\tval = $item.attr('src');\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\t\t\tval = $item.text();\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\tif (val !== null && val !== \"\") {\n\t\t\t\t\t\t\t\t\t\t\t\tfields[attr.toLowerCase()] = fields[attr.toLowerCase()] ? fields[attr.toLowerCase()] + \", \" +  val : val;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t// add the item\n\t\t\t\t\t\t\tsimpleCart.add(fields);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]);\n\t\t\t});\n\n\n\t\t\t/*******************************************************************\n\t\t\t *\tDOM READY\n\t\t\t *******************************************************************/\n\t\t\t// Cleanup functions for the document ready method\n\t\t\t// used from jQuery\n\t\t\t/*global DOMContentLoaded */\n\t\t\tif (document.addEventListener) {\n\t\t\t\twindow.DOMContentLoaded = function () {\n\t\t\t\t\tdocument.removeEventListener(\"DOMContentLoaded\", DOMContentLoaded, false);\n\t\t\t\t\tsimpleCart.init();\n\t\t\t\t};\n\n\t\t\t} else if (document.attachEvent) {\n\t\t\t\twindow.DOMContentLoaded = function () {\n\t\t\t\t\t// Make sure body exists, at least, in case IE gets a little overzealous (ticket #5443).\n\t\t\t\t\tif (document.readyState === \"complete\") {\n\t\t\t\t\t\tdocument.detachEvent(\"onreadystatechange\", DOMContentLoaded);\n\t\t\t\t\t\tsimpleCart.init();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\t// The DOM ready check for Internet Explorer\n\t\t\t// used from jQuery\n\t\t\tfunction doScrollCheck() {\n\t\t\t\tif (simpleCart.isReady) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\t// If IE is used, use the trick by Diego Perini\n\t\t\t\t\t// http://javascript.nwbox.com/IEContentLoaded/\n\t\t\t\t\tdocument.documentElement.doScroll(\"left\");\n\t\t\t\t} catch (e) {\n\t\t\t\t\tsetTimeout(doScrollCheck, 1);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// and execute any waiting functions\n\t\t\t\tsimpleCart.init();\n\t\t\t}\n\t\t\t\n\t\t\t// bind ready event used from jquery\n\t\t\tfunction sc_BindReady () {\n\n\t\t\t\t// Catch cases where $(document).ready() is called after the\n\t\t\t\t// browser event has already occurred.\n\t\t\t\tif (document.readyState === \"complete\") {\n\t\t\t\t\t// Handle it asynchronously to allow scripts the opportunity to delay ready\n\t\t\t\t\treturn setTimeout(simpleCart.init, 1);\n\t\t\t\t}\n\n\t\t\t\t// Mozilla, Opera and webkit nightlies currently support this event\n\t\t\t\tif (document.addEventListener) {\n\t\t\t\t\t// Use the handy event callback\n\t\t\t\t\tdocument.addEventListener(\"DOMContentLoaded\", DOMContentLoaded, false);\n\n\t\t\t\t\t// A fallback to window.onload, that will always work\n\t\t\t\t\twindow.addEventListener(\"load\", simpleCart.init, false);\n\n\t\t\t\t// If IE event model is used\n\t\t\t\t} else if (document.attachEvent) {\n\t\t\t\t\t// ensure firing before onload,\n\t\t\t\t\t// maybe late but safe also for iframes\n\t\t\t\t\tdocument.attachEvent(\"onreadystatechange\", DOMContentLoaded);\n\n\t\t\t\t\t// A fallback to window.onload, that will always work\n\t\t\t\t\twindow.attachEvent(\"onload\", simpleCart.init);\n\n\t\t\t\t\t// If IE and not a frame\n\t\t\t\t\t// continually check to see if the document is ready\n\t\t\t\t\tvar toplevel = false;\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\ttoplevel = window.frameElement === null;\n\t\t\t\t\t} catch (e) {}\n\n\t\t\t\t\tif (document.documentElement.doScroll && toplevel) {\n\t\t\t\t\t\tdoScrollCheck();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// bind the ready event\n\t\t\tsc_BindReady();\n\n\t\t\treturn simpleCart;\n\t\t};\n\n\n\twindow.simpleCart = generateSimpleCart();\n\n}(window, document));\n\n/************ JSON *************/\nvar JSON;JSON||(JSON={});\n(function () {function k(a) {return a<10?\"0\"+a:a}function o(a) {p.lastIndex=0;return p.test(a)?'\"'+a.replace(p,function (a) {var c=r[a];return typeof c===\"string\"?c:\"\\\\u\"+(\"0000\"+a.charCodeAt(0).toString(16)).slice(-4)})+'\"':'\"'+a+'\"'}function l(a,j) {var c,d,h,m,g=e,f,b=j[a];b&&typeof b===\"object\"&&typeof b.toJSON===\"function\"&&(b=b.toJSON(a));typeof i===\"function\"&&(b=i.call(j,a,b));switch(typeof b) {case \"string\":return o(b);case \"number\":return isFinite(b)?String(b):\"null\";case \"boolean\":case \"null\":return String(b);case \"object\":if (!b)return\"null\";\ne += n;f=[];if (Object.prototype.toString.apply(b)===\"[object Array]\") {m=b.length;for (c=0;c<m;c += 1)f[c]=l(c,b)||\"null\";h=f.length===0?\"[]\":e?\"[\\n\"+e+f.join(\",\\n\"+e)+\"\\n\"+g+\"]\":\"[\"+f.join(\",\")+\"]\";e=g;return h}if (i&&typeof i===\"object\") {m=i.length;for (c=0;c<m;c += 1)typeof i[c]===\"string\"&&(d=i[c],(h=l(d,b))&&f.push(o(d)+(e?\": \":\":\")+h))}else for (d in b)Object.prototype.hasOwnProperty.call(b,d)&&(h=l(d,b))&&f.push(o(d)+(e?\": \":\":\")+h);h=f.length===0?\"{}\":e?\"{\\n\"+e+f.join(\",\\n\"+e)+\"\\n\"+g+\"}\":\"{\"+f.join(\",\")+\n\"}\";e=g;return h}}if (typeof Date.prototype.toJSON!==\"function\")Date.prototype.toJSON=function () {return isFinite(this.valueOf())?this.getUTCFullYear()+\"-\"+k(this.getUTCMonth()+1)+\"-\"+k(this.getUTCDate())+\"T\"+k(this.getUTCHours())+\":\"+k(this.getUTCMinutes())+\":\"+k(this.getUTCSeconds())+\"Z\":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function () {return this.valueOf()};var q=/[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,\np=/[\\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,e,n,r={\"\\u0008\":\"\\\\b\",\"\\t\":\"\\\\t\",\"\\n\":\"\\\\n\",\"\\u000c\":\"\\\\f\",\"\\r\":\"\\\\r\",'\"':'\\\\\"',\"\\\\\":\"\\\\\\\\\"},i;if (typeof JSON.stringify!==\"function\")JSON.stringify=function (a,j,c) {var d;n=e=\"\";if (typeof c===\"number\")for (d=0;d<c;d += 1)n += \" \";else typeof c===\"string\"&&(n=c);if ((i=j)&&typeof j!==\"function\"&&(typeof j!==\"object\"||typeof j.length!==\"number\"))throw Error(\"JSON.stringify\");return l(\"\",\n{\"\":a})};if (typeof JSON.parse!==\"function\")JSON.parse=function (a,e) {function c(a,d) {var g,f,b=a[d];if (b&&typeof b===\"object\")for (g in b)Object.prototype.hasOwnProperty.call(b,g)&&(f=c(b,g),f!==void 0?b[g]=f:delete b[g]);return e.call(a,d,b)}var d,a=String(a);q.lastIndex=0;q.test(a)&&(a=a.replace(q,function (a) {return\"\\\\u\"+(\"0000\"+a.charCodeAt(0).toString(16)).slice(-4)}));if (/^[\\],:{}\\s]*$/.test(a.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g,\"@\").replace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g,\n\"]\").replace(/(?:^|:|,)(?:\\s*\\[)+/g,\"\")))return d=eval(\"(\"+a+\")\"),typeof e===\"function\"?c({\"\":d},\"\"):d;throw new SyntaxError(\"JSON.parse\");}})();\n\n\n/************ HTML5 Local Storage Support *************/\n(function () {if (!this.localStorage)if (this.globalStorage)try {this.localStorage=this.globalStorage}catch(e) {}else{var a=document.createElement(\"div\");a.style.display=\"none\";document.getElementsByTagName(\"head\")[0].appendChild(a);if (a.addBehavior) {a.addBehavior(\"#default#userdata\");var d=this.localStorage={length:0,setItem:function (b,d) {a.load(\"localStorage\");b=c(b);a.getAttribute(b)||this.length++;a.setAttribute(b,d);a.save(\"localStorage\")},getItem:function (b) {a.load(\"localStorage\");b=c(b);return a.getAttribute(b)},\nremoveItem:function (b) {a.load(\"localStorage\");b=c(b);a.removeAttribute(b);a.save(\"localStorage\");this.length=0},clear:function () {a.load(\"localStorage\");for (var b=0;attr=a.XMLDocument.documentElement.attributes[b++];)a.removeAttribute(attr.name);a.save(\"localStorage\");this.length=0},key:function (b) {a.load(\"localStorage\");return a.XMLDocument.documentElement.attributes[b]}},c=function (a) {return a.replace(/[^-._0-9A-Za-z\\xb7\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u037d\\u37f-\\u1fff\\u200c-\\u200d\\u203f\\u2040\\u2070-\\u218f]/g,\n\"-\")};a.load(\"localStorage\");d.length=a.XMLDocument.documentElement.attributes.length}}})();\n","undoManager":{"mark":-2,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":1931,"column":0},"action":"insert","lines":["/*~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~","\tCopyright (c) 2012 Brett Wejrowski","","\twojodesign.com","\tsimplecartjs.org","\thttp://github.com/wojodesign/simplecart-js","","\tVERSION 3.0.5","","\tDual licensed under the MIT or GPL licenses.","~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~*/","/*jslint browser: true, unparam: true, white: true, nomen: true, regexp: true, maxerr: 50, indent: 4 */","","(function (window, document) {","\t/*global HTMLElement */","","\tvar typeof_string\t\t\t= typeof \"\",","\t\ttypeof_undefined\t\t= typeof undefined,","\t\ttypeof_function\t\t\t= typeof function () {},","\t\ttypeof_object\t\t\t= typeof {},","\t\tisTypeOf\t\t\t\t= function (item, type) { return typeof item === type; },","\t\tisString\t\t\t\t= function (item) { return isTypeOf(item, typeof_string); },","\t\tisUndefined\t\t\t\t= function (item) { return isTypeOf(item, typeof_undefined); },","\t\tisFunction\t\t\t\t= function (item) { return isTypeOf(item, typeof_function); },","","\t\tisObject\t\t\t\t= function (item) { return isTypeOf(item, typeof_object); },","\t\t//Returns true if it is a DOM element","\t\tisElement\t\t\t\t= function (o) {","\t\t\treturn typeof HTMLElement === \"object\" ? o instanceof HTMLElement : typeof o === \"object\" && o.nodeType === 1 && typeof o.nodeName === \"string\";","\t\t},","","","","\t\tgenerateSimpleCart = function (space) {","","\t\t\t// stealing this from selectivizr","\t\t\tvar selectorEngines = {","\t\t\t\t\"MooTools\"\t\t\t\t\t\t\t: \"$$\",","\t\t\t\t\"Prototype\"\t\t\t\t\t\t\t: \"$$\",","\t\t\t\t\"jQuery\"\t\t\t\t\t\t\t: \"*\"","\t\t\t},","","","\t\t\t\t// local variables for internal use","\t\t\t\titem_id\t\t\t\t\t= 0,","\t\t\t\titem_id_namespace\t\t= \"SCI-\",","\t\t\t\tsc_items\t\t\t\t= {},","\t\t\t\tnamespace\t\t\t\t= space || \"simpleCart\",","\t\t\t\tselectorFunctions\t\t= {},","\t\t\t\teventFunctions\t\t\t= {},","\t\t\t\tbaseEvents\t\t\t\t= {},","","\t\t\t\t// local references","\t\t\t\tlocalStorage\t\t\t= window.localStorage,","\t\t\t\tconsole\t\t\t\t\t= window.console || { msgs: [], log: function (msg) { console.msgs.push(msg); } },","","\t\t\t\t// used in views ","\t\t\t\t_VALUE_\t\t= 'value',","\t\t\t\t_TEXT_\t\t= 'text',","\t\t\t\t_HTML_\t\t= 'html',","\t\t\t\t_CLICK_\t\t= 'click',","","\t\t\t\t// Currencies","\t\t\t\tcurrencies = {","\t\t\t\t\t\"USD\": { code: \"USD\", symbol: \"&#36;\", name: \"US Dollar\" },","\t\t\t\t\t\"AUD\": { code: \"AUD\", symbol: \"&#36;\", name: \"Australian Dollar\" },","\t\t\t\t\t\"BRL\": { code: \"BRL\", symbol: \"R&#36;\", name: \"Brazilian Real\" },","\t\t\t\t\t\"CAD\": { code: \"CAD\", symbol: \"&#36;\", name: \"Canadian Dollar\" },","\t\t\t\t\t\"CZK\": { code: \"CZK\", symbol: \"&nbsp;&#75;&#269;\", name: \"Czech Koruna\", after: true },","\t\t\t\t\t\"DKK\": { code: \"DKK\", symbol: \"DKK&nbsp;\", name: \"Danish Krone\" },","\t\t\t\t\t\"EUR\": { code: \"EUR\", symbol: \"&euro;\", name: \"Euro\" },","\t\t\t\t\t\"HKD\": { code: \"HKD\", symbol: \"&#36;\", name: \"Hong Kong Dollar\" },","\t\t\t\t\t\"HUF\": { code: \"HUF\", symbol: \"&#70;&#116;\", name: \"Hungarian Forint\" },","\t\t\t\t\t\"ILS\": { code: \"ILS\", symbol: \"&#8362;\", name: \"Israeli New Sheqel\" },","\t\t\t\t\t\"JPY\": { code: \"JPY\", symbol: \"&yen;\", name: \"Japanese Yen\", accuracy: 0 },","\t\t\t\t\t\"MXN\": { code: \"MXN\", symbol: \"&#36;\", name: \"Mexican Peso\" },","\t\t\t\t\t\"NOK\": { code: \"NOK\", symbol: \"NOK&nbsp;\", name: \"Norwegian Krone\" },","\t\t\t\t\t\"NZD\": { code: \"NZD\", symbol: \"&#36;\", name: \"New Zealand Dollar\" },","\t\t\t\t\t\"PLN\": { code: \"PLN\", symbol: \"PLN&nbsp;\", name: \"Polish Zloty\" },","\t\t\t\t\t\"GBP\": { code: \"GBP\", symbol: \"&pound;\", name: \"Pound Sterling\" },","\t\t\t\t\t\"SGD\": { code: \"SGD\", symbol: \"&#36;\", name: \"Singapore Dollar\" },","\t\t\t\t\t\"SEK\": { code: \"SEK\", symbol: \"SEK&nbsp;\", name: \"Swedish Krona\" },","\t\t\t\t\t\"CHF\": { code: \"CHF\", symbol: \"CHF&nbsp;\", name: \"Swiss Franc\" },","\t\t\t\t\t\"THB\": { code: \"THB\", symbol: \"&#3647;\", name: \"Thai Baht\" },","\t\t\t\t\t\"BTC\": { code: \"BTC\", symbol: \" BTC\", name: \"Bitcoin\", accuracy: 4, after: true\t}","\t\t\t\t},","","\t\t\t\t// default options","\t\t\t\tsettings = {","\t\t\t\t\tcheckout\t\t\t\t: { type: \"PayPal\", email: \"you@yours.com\" },","\t\t\t\t\tcurrency\t\t\t\t: \"USD\",","\t\t\t\t\tlanguage\t\t\t\t: \"english-us\",","","\t\t\t\t\tcartStyle\t\t\t\t: \"div\",","\t\t\t\t\tcartColumns\t\t\t: [","\t\t\t\t\t\t{ attr: \"name\", label: \"Name\" },","\t\t\t\t\t\t{ attr: \"price\", label: \"Price\", view: 'currency' },","\t\t\t\t\t\t{ view: \"decrement\", label: false },","\t\t\t\t\t\t{ attr: \"quantity\", label: \"Qty\" },","\t\t\t\t\t\t{ view: \"increment\", label: false },","\t\t\t\t\t\t{ attr: \"total\", label: \"SubTotal\", view: 'currency' },","\t\t\t\t\t\t{ view: \"remove\", text: \"Remove\", label: false }","\t\t\t\t\t],","","\t\t\t\t\texcludeFromCheckout\t: ['thumb'],","","\t\t\t\t\tshippingFlatRate\t\t: 0,","\t\t\t\t\tshippingQuantityRate\t: 0,","\t\t\t\t\tshippingTotalRate\t\t: 0,","\t\t\t\t\tshippingCustom\t\t: null,","","\t\t\t\t\ttaxRate\t\t\t\t: 0,","\t\t\t\t\t","\t\t\t\t\ttaxShipping\t\t\t: false,","","\t\t\t\t\tdata\t\t\t\t: {}","","\t\t\t\t},","","","\t\t\t\t// main simpleCart object, function call is used for setting options","\t\t\t\tsimpleCart = function (options) {","\t\t\t\t\t// shortcut for simpleCart.ready","\t\t\t\t\tif (isFunction(options)) {","\t\t\t\t\t\treturn simpleCart.ready(options);","\t\t\t\t\t}","","\t\t\t\t\t// set options","\t\t\t\t\tif (isObject(options)) {","\t\t\t\t\t\treturn simpleCart.extend(settings, options);","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\t// selector engine","\t\t\t\t$engine,","","\t\t\t\t// built in cart views for item cells","\t\t\t\tcartColumnViews;","","\t\t\t// function for extending objects","\t\t\tsimpleCart.extend = function (target, opts) {","\t\t\t\tvar next;","","\t\t\t\tif (isUndefined(opts)) {","\t\t\t\t\topts = target;","\t\t\t\t\ttarget = simpleCart;","\t\t\t\t}","","\t\t\t\tfor (next in opts) {","\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(opts, next)) {","\t\t\t\t\t\ttarget[next] = opts[next];","\t\t\t\t\t}","\t\t\t\t}","\t\t\t\treturn target;","\t\t\t};","","\t\t\t// create copy function","\t\t\tsimpleCart.extend({","\t\t\t\tcopy: function (n) {","\t\t\t\t\tvar cp = generateSimpleCart(n);","\t\t\t\t\tcp.init();","\t\t\t\t\treturn cp;","\t\t\t\t}","\t\t\t});","","\t\t\t// add in the core functionality","\t\t\tsimpleCart.extend({","","\t\t\t\tisReady: false,","","\t\t\t\t// this is where the magic happens, the add function","\t\t\t\tadd: function (values, opt_quiet) {","\t\t\t\t\tvar info\t\t= values || {},","\t\t\t\t\t\tnewItem\t\t= new simpleCart.Item(info),","\t\t\t\t\t\taddItem \t= true,","\t\t\t\t\t\t// optionally supress event triggers","\t\t\t\t\t\tquiet \t\t= opt_quiet === true ? opt_quiet : false,","\t\t\t\t\t\toldItem;","","\t\t\t\t\t// trigger before add event","\t\t\t\t\tif (!quiet) {","\t\t\t\t\t  \taddItem = simpleCart.trigger('beforeAdd', [newItem]);","\t\t\t\t\t","\t\t\t\t\t\tif (addItem === false) {","\t\t\t\t\t\t\treturn false;","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t\t","\t\t\t\t\t// if the new item already exists, increment the value","\t\t\t\t\toldItem = simpleCart.has(newItem);","\t\t\t\t\tif (oldItem) {","\t\t\t\t\t\toldItem.increment(newItem.quantity());","\t\t\t\t\t\tnewItem = oldItem;","","\t\t\t\t\t// otherwise add the item","\t\t\t\t\t} else {","\t\t\t\t\t\tsc_items[newItem.id()] = newItem;","\t\t\t\t\t}","","\t\t\t\t\t// update the cart","\t\t\t\t\tsimpleCart.update();","","\t\t\t\t\tif (!quiet) {","\t\t\t\t\t\t// trigger after add event","\t\t\t\t\t\tsimpleCart.trigger('afterAdd', [newItem, isUndefined(oldItem)]);","\t\t\t\t\t}","","\t\t\t\t\t// return a reference to the added item","\t\t\t\t\treturn newItem;","\t\t\t\t},","","","\t\t\t\t// iteration function","\t\t\t\teach: function (array, callback) {","\t\t\t\t\tvar next,","\t\t\t\t\t\tx = 0,","\t\t\t\t\t\tresult,","\t\t\t\t\t\tcb,","\t\t\t\t\t\titems;","","\t\t\t\t\tif (isFunction(array)) {","\t\t\t\t\t\tcb = array;","\t\t\t\t\t\titems = sc_items;","\t\t\t\t\t} else if (isFunction(callback)) {","\t\t\t\t\t\tcb = callback;","\t\t\t\t\t\titems = array;","\t\t\t\t\t} else {","\t\t\t\t\t\treturn;","\t\t\t\t\t}","","\t\t\t\t\tfor (next in items) {","\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(items, next)) {","\t\t\t\t\t\t\tresult = cb.call(simpleCart, items[next], x, next);","\t\t\t\t\t\t\tif (result === false) {","\t\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t\tx += 1;","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tfind: function (id) {","\t\t\t\t\tvar items = [];","","\t\t\t\t\t// return object for id if it exists","\t\t\t\t\tif (isObject(sc_items[id])) {","\t\t\t\t\t\treturn sc_items[id];","\t\t\t\t\t}","\t\t\t\t\t// search through items with the given criteria","\t\t\t\t\tif (isObject(id)) {","\t\t\t\t\t\tsimpleCart.each(function (item) {","\t\t\t\t\t\t\tvar match = true;","\t\t\t\t\t\t\tsimpleCart.each(id, function (val, x, attr) {","","\t\t\t\t\t\t\t\tif (isString(val)) {","\t\t\t\t\t\t\t\t\t// less than or equal to","\t\t\t\t\t\t\t\t\tif (val.match(/<=.*/)) {","\t\t\t\t\t\t\t\t\t\tval = parseFloat(val.replace('<=', ''));","\t\t\t\t\t\t\t\t\t\tif (!(item.get(attr) && parseFloat(item.get(attr)) <= val)) {","\t\t\t\t\t\t\t\t\t\t\tmatch = false;","\t\t\t\t\t\t\t\t\t\t}","","\t\t\t\t\t\t\t\t\t// less than","\t\t\t\t\t\t\t\t\t} else if (val.match(/</)) {","\t\t\t\t\t\t\t\t\t\tval = parseFloat(val.replace('<', ''));","\t\t\t\t\t\t\t\t\t\tif (!(item.get(attr) && parseFloat(item.get(attr)) < val)) {","\t\t\t\t\t\t\t\t\t\t\tmatch = false;","\t\t\t\t\t\t\t\t\t\t}","","\t\t\t\t\t\t\t\t\t// greater than or equal to","\t\t\t\t\t\t\t\t\t} else if (val.match(/>=/)) {","\t\t\t\t\t\t\t\t\t\tval = parseFloat(val.replace('>=', ''));","\t\t\t\t\t\t\t\t\t\tif (!(item.get(attr) && parseFloat(item.get(attr)) >= val)) {","\t\t\t\t\t\t\t\t\t\t\tmatch = false;","\t\t\t\t\t\t\t\t\t\t}","","\t\t\t\t\t\t\t\t\t// greater than","\t\t\t\t\t\t\t\t\t} else if (val.match(/>/)) {","\t\t\t\t\t\t\t\t\t\tval = parseFloat(val.replace('>', ''));","\t\t\t\t\t\t\t\t\t\tif (!(item.get(attr) && parseFloat(item.get(attr)) > val)) {","\t\t\t\t\t\t\t\t\t\t\tmatch = false;","\t\t\t\t\t\t\t\t\t\t}","","\t\t\t\t\t\t\t\t\t// equal to","\t\t\t\t\t\t\t\t\t} else if (!(item.get(attr) && item.get(attr) === val)) {","\t\t\t\t\t\t\t\t\t\tmatch = false;","\t\t\t\t\t\t\t\t\t}","","\t\t\t\t\t\t\t\t// equal to non string","\t\t\t\t\t\t\t\t} else if (!(item.get(attr) && item.get(attr) === val)) {","\t\t\t\t\t\t\t\t\tmatch = false;","\t\t\t\t\t\t\t\t}","","\t\t\t\t\t\t\t\treturn match;","\t\t\t\t\t\t\t});","","\t\t\t\t\t\t\t// add the item if it matches","\t\t\t\t\t\t\tif (match) {","\t\t\t\t\t\t\t\titems.push(item);","\t\t\t\t\t\t\t}","\t\t\t\t\t\t});","\t\t\t\t\t\treturn items;","\t\t\t\t\t}","","\t\t\t\t\t// if no criteria is given we return all items","\t\t\t\t\tif (isUndefined(id)) {","","\t\t\t\t\t\t// use a new array so we don't give a reference to the","\t\t\t\t\t\t// cart's item array","\t\t\t\t\t\tsimpleCart.each(function (item) {","\t\t\t\t\t\t\titems.push(item);","\t\t\t\t\t\t});","\t\t\t\t\t\treturn items;","\t\t\t\t\t}","","\t\t\t\t\t// return empty array as default","\t\t\t\t\treturn items;","\t\t\t\t},","","\t\t\t\t// return all items","\t\t\t\titems: function () {","\t\t\t\t\treturn this.find();","\t\t\t\t},","","\t\t\t\t// check to see if item is in the cart already","\t\t\t\thas: function (item) {","\t\t\t\t\tvar match = false;","","\t\t\t\t\tsimpleCart.each(function (testItem) {","\t\t\t\t\t\tif (testItem.equals(item)) {","\t\t\t\t\t\t\tmatch = testItem;","\t\t\t\t\t\t}","\t\t\t\t\t});","\t\t\t\t\treturn match;","\t\t\t\t},","","\t\t\t\t// empty the cart","\t\t\t\tempty: function () {","\t\t\t\t\t// remove each item individually so we see the remove events","\t\t\t\t\tvar newItems = {};","\t\t\t\t\tsimpleCart.each(function (item) {","\t\t\t\t\t\t// send a param of true to make sure it doesn't","\t\t\t\t\t\t// update after every removal","\t\t\t\t\t\t// keep the item if the function returns false,","\t\t\t\t\t\t// because we know it has been prevented ","\t\t\t\t\t\t// from being removed","\t\t\t\t\t\tif (item.remove(true) === false) {","\t\t\t\t\t\t\tnewItems[item.id()] = item","\t\t\t\t\t\t}","\t\t\t\t\t});","\t\t\t\t\tsc_items = newItems;","\t\t\t\t\tsimpleCart.update();","\t\t\t\t},","","","\t\t\t\t// functions for accessing cart info","\t\t\t\tquantity: function () {","\t\t\t\t\tvar quantity = 0;","\t\t\t\t\tsimpleCart.each(function (item) {","\t\t\t\t\t\tquantity += item.quantity();","\t\t\t\t\t});","\t\t\t\t\treturn quantity;","\t\t\t\t},","","\t\t\t\ttotal: function () {","\t\t\t\t\tvar total = 0;","\t\t\t\t\tsimpleCart.each(function (item) {","\t\t\t\t\t\ttotal += item.total();","\t\t\t\t\t});","\t\t\t\t\treturn total;","\t\t\t\t},","","\t\t\t\tgrandTotal: function () {","\t\t\t\t\treturn simpleCart.total() + simpleCart.tax() + simpleCart.shipping();","\t\t\t\t},","","","\t\t\t\t// updating functions","\t\t\t\tupdate: function () {","\t\t\t\t\tsimpleCart.save();","\t\t\t\t\tsimpleCart.trigger(\"update\");","\t\t\t\t},","","\t\t\t\tinit: function () {","\t\t\t\t\tsimpleCart.load();","\t\t\t\t\tsimpleCart.update();","\t\t\t\t\tsimpleCart.ready();","\t\t\t\t},","","\t\t\t\t// view management","\t\t\t\t$: function (selector) {","\t\t\t\t\treturn new simpleCart.ELEMENT(selector);","\t\t\t\t},","","\t\t\t\t$create: function (tag) {","\t\t\t\t\treturn simpleCart.$(document.createElement(tag));","\t\t\t\t},","","\t\t\t\tsetupViewTool: function () {","\t\t\t\t\tvar members, member, context = window, engine;","","\t\t\t\t\t// Determine the \"best fit\" selector engine","\t\t\t\t\tfor (engine in selectorEngines) {","\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(selectorEngines, engine) && window[engine]) {","\t\t\t\t\t\t\tmembers = selectorEngines[engine].replace(\"*\", engine).split(\".\");","\t\t\t\t\t\t\tmember = members.shift();","\t\t\t\t\t\t\tif (member) {","\t\t\t\t\t\t\t\tcontext = context[member];","\t\t\t\t\t\t\t}","\t\t\t\t\t\t\tif (typeof context === \"function\") {","\t\t\t\t\t\t\t\t// set the selector engine and extend the prototype of our","\t\t\t\t\t\t\t\t// element wrapper class","\t\t\t\t\t\t\t\t$engine = context;","\t\t\t\t\t\t\t\tsimpleCart.extend(simpleCart.ELEMENT._, selectorFunctions[engine]);","\t\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\t// return a list of id's in the cart","\t\t\t\tids: function () {","\t\t\t\t\tvar ids = [];","\t\t\t\t\tsimpleCart.each(function (item) {","\t\t\t\t\t\tids.push(item.id());","\t\t\t\t\t});","\t\t\t\t\treturn ids;","","\t\t\t\t},","","","\t\t\t\t// storage","\t\t\t\tsave: function () {","\t\t\t\t\tsimpleCart.trigger('beforeSave');","","\t\t\t\t\tvar items = {};","","\t\t\t\t\t// save all the items","\t\t\t\t\tsimpleCart.each(function (item) {","\t\t\t\t\t\titems[item.id()] = simpleCart.extend(item.fields(), item.options());","\t\t\t\t\t});","","\t\t\t\t\tlocalStorage.setItem(namespace + \"_items\", JSON.stringify(items));","","\t\t\t\t\tsimpleCart.trigger('afterSave');","\t\t\t\t},","","\t\t\t\tload: function () {","","\t\t\t\t\t// empty without the update","\t\t\t\t\tsc_items = {};","","\t\t\t\t\tvar items = localStorage.getItem(namespace + \"_items\");","","\t\t\t\t\tif (!items) {","\t\t\t\t\t\treturn;","\t\t\t\t\t}","\t\t\t\t\t","\t\t\t\t\t// we wrap this in a try statement so we can catch ","\t\t\t\t\t// any json parsing errors. no more stick and we","\t\t\t\t\t// have a playing card pluckin the spokes now...","\t\t\t\t\t// soundin like a harley.","\t\t\t\t\ttry {","\t\t\t\t\t\tsimpleCart.each(JSON.parse(items), function (item) {","\t\t\t\t\t\t\tsimpleCart.add(item, true);","\t\t\t\t\t\t});","\t\t\t\t\t} catch (e){","\t\t\t\t\t\tsimpleCart.error( \"Error Loading data: \" + e );","\t\t\t\t\t}","","","\t\t\t\t\tsimpleCart.trigger('load');","\t\t\t\t},","","\t\t\t\t// ready function used as a shortcut for bind('ready',fn)","\t\t\t\tready: function (fn) {","","\t\t\t\t\tif (isFunction(fn)) {","\t\t\t\t\t\t// call function if already ready already","\t\t\t\t\t\tif (simpleCart.isReady) {","\t\t\t\t\t\t\tfn.call(simpleCart);","","\t\t\t\t\t\t// bind if not ready","\t\t\t\t\t\t} else {","\t\t\t\t\t\t\tsimpleCart.bind('ready', fn);","\t\t\t\t\t\t}","","\t\t\t\t\t// trigger ready event","\t\t\t\t\t} else if (isUndefined(fn) && !simpleCart.isReady) {","\t\t\t\t\t\tsimpleCart.trigger('ready');","\t\t\t\t\t\tsimpleCart.isReady = true;","\t\t\t\t\t}","","\t\t\t\t},","","","\t\t\t\terror: function (message) {","\t\t\t\t\tvar msg = \"\";","\t\t\t\t\tif (isString(message)) {","\t\t\t\t\t\tmsg = message;","\t\t\t\t\t} else if (isObject(message) && isString(message.message)) {","\t\t\t\t\t\tmsg = message.message;","\t\t\t\t\t}","\t\t\t\t\ttry { console.log(\"simpleCart(js) Error: \" + msg); } catch (e) {}","\t\t\t\t\tsimpleCart.trigger('error', [message]);","\t\t\t\t}","\t\t\t});","","","\t\t\t/*******************************************************************","\t\t\t *\tTAX AND SHIPPING","\t\t\t *******************************************************************/","\t\t\tsimpleCart.extend({","","\t\t\t\t// TODO: tax and shipping","\t\t\t\ttax: function () {","\t\t\t\t\tvar totalToTax = settings.taxShipping ? simpleCart.total() + simpleCart.shipping() : simpleCart.total(),","\t\t\t\t\t\tcost = simpleCart.taxRate() * totalToTax;","\t\t\t\t\t","\t\t\t\t\tsimpleCart.each(function (item) {","\t\t\t\t\t\tif (item.get('tax')) {","\t\t\t\t\t\t\tcost += item.get('tax');","\t\t\t\t\t\t} else if (item.get('taxRate')) {","\t\t\t\t\t\t\tcost += item.get('taxRate') * item.total();","\t\t\t\t\t\t}","\t\t\t\t\t});","\t\t\t\t\treturn parseFloat(cost);","\t\t\t\t},","\t\t\t\t","\t\t\t\ttaxRate: function () {","\t\t\t\t\treturn settings.taxRate || 0;","\t\t\t\t},","","\t\t\t\tshipping: function (opt_custom_function) {","","\t\t\t\t\t// shortcut to extend options with custom shipping","\t\t\t\t\tif (isFunction(opt_custom_function)) {","\t\t\t\t\t\tsimpleCart({","\t\t\t\t\t\t\tshippingCustom: opt_custom_function","\t\t\t\t\t\t});","\t\t\t\t\t\treturn;","\t\t\t\t\t}","","\t\t\t\t\tvar cost = settings.shippingQuantityRate * simpleCart.quantity() +","\t\t\t\t\t\t\tsettings.shippingTotalRate * simpleCart.total() +","\t\t\t\t\t\t\tsettings.shippingFlatRate;","","\t\t\t\t\tif (isFunction(settings.shippingCustom)) {","\t\t\t\t\t\tcost += settings.shippingCustom.call(simpleCart);","\t\t\t\t\t}","","\t\t\t\t\tsimpleCart.each(function (item) {","\t\t\t\t\t\tcost += parseFloat(item.get('shipping') || 0);","\t\t\t\t\t});","\t\t\t\t\treturn parseFloat(cost);","\t\t\t\t}","","\t\t\t});","","\t\t\t/*******************************************************************","\t\t\t *\tCART VIEWS","\t\t\t *******************************************************************/","","\t\t\t// built in cart views for item cells","\t\t\tcartColumnViews = {","\t\t\t\tattr: function (item, column) {","\t\t\t\t\treturn item.get(column.attr) || \"\";","\t\t\t\t},","","\t\t\t\tcurrency: function (item, column) {","\t\t\t\t\treturn simpleCart.toCurrency(item.get(column.attr) || 0);","\t\t\t\t},","","\t\t\t\tlink: function (item, column) {","\t\t\t\t\treturn \"<a href='\" + item.get(column.attr) + \"'>\" + column.text + \"</a>\";","\t\t\t\t},","","\t\t\t\tdecrement: function (item, column) {","\t\t\t\t\treturn \"<a href='javascript:;' class='\" + namespace + \"_decrement'>\" + (column.text || \"-\") + \"</a>\";","\t\t\t\t},","","\t\t\t\tincrement: function (item, column) {","\t\t\t\t\treturn \"<a href='javascript:;' class='\" + namespace + \"_increment'>\" + (column.text || \"+\") + \"</a>\";","\t\t\t\t},","","\t\t\t\timage: function (item, column) {","\t\t\t\t\treturn \"<img src='\" + item.get(column.attr) + \"'/>\";","\t\t\t\t},","","\t\t\t\tinput: function (item, column) {","\t\t\t\t\treturn \"<input type='text' value='\" + item.get(column.attr) + \"' class='\" + namespace + \"_input'/>\";","\t\t\t\t},","","\t\t\t\tremove: function (item, column) {","\t\t\t\t\treturn \"<a href='javascript:;' class='\" + namespace + \"_remove'>\" + (column.text || \"X\") + \"</a>\";","\t\t\t\t}","\t\t\t};","","\t\t\t// cart column wrapper class and functions","\t\t\tfunction cartColumn(opts) {","\t\t\t\tvar options = opts || {};","\t\t\t\treturn simpleCart.extend({","\t\t\t\t\tattr\t\t\t: \"\",","\t\t\t\t\tlabel\t\t\t: \"\",","\t\t\t\t\tview\t\t\t: \"attr\",","\t\t\t\t\ttext\t\t\t: \"\",","\t\t\t\t\tclassName\t\t: \"\",","\t\t\t\t\thide\t\t\t: false","\t\t\t\t}, options);","\t\t\t}","","\t\t\tfunction cartCellView(item, column) {","\t\t\t\tvar viewFunc = isFunction(column.view) ? column.view : isString(column.view) && isFunction(cartColumnViews[column.view]) ? cartColumnViews[column.view] : cartColumnViews.attr;","","\t\t\t\treturn viewFunc.call(simpleCart, item, column);","\t\t\t}","","","\t\t\tsimpleCart.extend({","","\t\t\t\t// write out cart","\t\t\t\twriteCart: function (selector) {","\t\t\t\t\tvar TABLE = settings.cartStyle.toLowerCase(),","\t\t\t\t\t\tisTable = TABLE === 'table',","\t\t\t\t\t\tTR = isTable ? \"tr\" : \"div\",","\t\t\t\t\t\tTH = isTable ? 'th' : 'div',","\t\t\t\t\t\tTD = isTable ? 'td' : 'div',","\t\t\t\t\t\tTHEAD = isTable ? 'thead' : 'div',","\t\t\t\t\t\tcart_container = simpleCart.$create(TABLE),","\t\t\t\t\t\tthead_container = simpleCart.$create(THEAD),","\t\t\t\t\t\theader_container = simpleCart.$create(TR).addClass('headerRow'),","\t\t\t\t\t\tcontainer = simpleCart.$(selector),","\t\t\t\t\t\tcolumn,","\t\t\t\t\t\tklass,","\t\t\t\t\t\tlabel,","\t\t\t\t\t\tx,","\t\t\t\t\t\txlen;","","\t\t\t\t\tcontainer.html(' ').append(cart_container);","","\t\t\t\t\tcart_container.append(thead_container);","","\t\t\t\t\tthead_container.append(header_container);","","","\t\t\t\t\t// create header","\t\t\t\t\tfor (x = 0, xlen = settings.cartColumns.length; x < xlen; x += 1) {","\t\t\t\t\t\tcolumn\t= cartColumn(settings.cartColumns[x]);","\t\t\t\t\t\tklass\t=  \"item-\" + (column.attr || column.view || column.label || column.text || \"cell\") + \" \" + column.className;","\t\t\t\t\t\tlabel\t= column.label || \"\";","","\t\t\t\t\t\t// append the header cell","\t\t\t\t\t\theader_container.append(","\t\t\t\t\t\t\tsimpleCart.$create(TH).addClass(klass).html(label)","\t\t\t\t\t\t);","\t\t\t\t\t}","","\t\t\t\t\t// cycle through the items","\t\t\t\t\tsimpleCart.each(function (item, y) {","\t\t\t\t\t\tsimpleCart.createCartRow(item, y, TR, TD, cart_container);","\t\t\t\t\t});","","\t\t\t\t\treturn cart_container;","\t\t\t\t},","","\t\t\t\t// generate a cart row from an item","\t\t\t\tcreateCartRow: function (item, y, TR, TD, container) {","\t\t\t\t\tvar row = simpleCart.$create(TR)","\t\t\t\t\t\t\t\t\t\t.addClass('itemRow row-' + y + \" \" + (y % 2 ? \"even\" : \"odd\"))","\t\t\t\t\t\t\t\t\t\t.attr('id', \"cartItem_\" + item.id()),","\t\t\t\t\t\tj,","\t\t\t\t\t\tjlen,","\t\t\t\t\t\tcolumn,","\t\t\t\t\t\tklass,","\t\t\t\t\t\tcontent,","\t\t\t\t\t\tcell;","","\t\t\t\t\tcontainer.append(row);","","\t\t\t\t\t// cycle through the columns to create each cell for the item","\t\t\t\t\tfor (j = 0, jlen = settings.cartColumns.length; j < jlen; j += 1) {","\t\t\t\t\t\tcolumn\t= cartColumn(settings.cartColumns[j]);","\t\t\t\t\t\tklass\t= \"item-\" + (column.attr || (isString(column.view) ? column.view : column.label || column.text || \"cell\")) + \" \" + column.className;","\t\t\t\t\t\tcontent = cartCellView(item, column);","\t\t\t\t\t\tcell\t= simpleCart.$create(TD).addClass(klass).html(content);","","\t\t\t\t\t\trow.append(cell);","\t\t\t\t\t}","\t\t\t\t\treturn row;","\t\t\t\t}","","\t\t\t});","","\t\t\t/*******************************************************************","\t\t\t *\tCART ITEM CLASS MANAGEMENT","\t\t\t *******************************************************************/","","\t\t\tsimpleCart.Item = function (info) {","","\t\t\t\t// we use the data object to track values for the item","\t\t\t\tvar _data = {},","\t\t\t\t\tme = this;","","\t\t\t\t// cycle through given attributes and set them to the data object","\t\t\t\tif (isObject(info)) {","\t\t\t\t\tsimpleCart.extend(_data, info);","\t\t\t\t}","","\t\t\t\t// set the item id","\t\t\t\titem_id += 1;","\t\t\t\t_data.id = _data.id || item_id_namespace + item_id;","\t\t\t\twhile (!isUndefined(sc_items[_data.id])) {","\t\t\t\t\titem_id += 1;","\t\t\t\t\t_data.id = item_id_namespace + item_id;","\t\t\t\t}","","\t\t\t\tfunction checkQuantityAndPrice() {","","\t\t\t\t\t// check to make sure price is valid","\t\t\t\t\tif (isString(_data.price)) {","\t\t\t\t\t   // trying to remove all chars that aren't numbers or '.'","\t\t\t\t\t\t_data.price = parseFloat(_data.price.replace(simpleCart.currency().decimal, \".\").replace(/[^0-9\\.]+/ig, \"\"));","","\t\t\t\t\t}","\t\t\t\t\tif (isNaN(_data.price)) {","\t\t\t\t\t\t_data.price = 0;","\t\t\t\t\t}","\t\t\t\t\tif (_data.price < 0) {","\t\t\t\t\t\t_data.price = 0;","\t\t\t\t\t}","","\t\t\t\t\t// check to make sure quantity is valid","\t\t\t\t\tif (isString(_data.quantity)) {","\t\t\t\t\t\t_data.quantity = parseInt(_data.quantity.replace(simpleCart.currency().delimiter, \"\"), 10);","\t\t\t\t\t}","\t\t\t\t\tif (isNaN(_data.quantity)) {","\t\t\t\t\t\t_data.quantity = 1;","\t\t\t\t\t}","\t\t\t\t\tif (_data.quantity <= 0) {","\t\t\t\t\t\tme.remove();","\t\t\t\t\t}","","\t\t\t\t}","","\t\t\t\t// getter and setter methods to access private variables","\t\t\t\tme.get = function (name, skipPrototypes) {","","\t\t\t\t\tvar usePrototypes = !skipPrototypes;","","\t\t\t\t\tif (isUndefined(name)) {","\t\t\t\t\t\treturn name;","\t\t\t\t\t}","","\t\t\t\t\t// return the value in order of the data object and then the prototype","\t\t\t\t\treturn isFunction(_data[name])\t? _data[name].call(me) :","\t\t\t\t\t\t\t!isUndefined(_data[name]) ? _data[name] :","","\t\t\t\t\t\t\tisFunction(me[name]) && usePrototypes\t\t? me[name].call(me) :","\t\t\t\t\t\t\t!isUndefined(me[name]) && usePrototypes\t? me[name] :","\t\t\t\t\t\t\t_data[name];","\t\t\t\t};","\t\t\t\tme.set = function (name, value) {","\t\t\t\t\tif (!isUndefined(name)) {","\t\t\t\t\t\t_data[name.toLowerCase()] = value;","\t\t\t\t\t\tif (name.toLowerCase() === 'price' || name.toLowerCase() === 'quantity') {","\t\t\t\t\t\t\tcheckQuantityAndPrice();","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t\treturn me;","\t\t\t\t};","\t\t\t\tme.equals = function (item) {","\t\t\t\t\tfor( var label in _data ){","\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(_data, label)) {","\t\t\t\t\t\t\tif (label !== 'quantity' && label !== 'id') {","\t\t\t\t\t\t\t\tif (item.get(label) !== _data[label]) {","\t\t\t\t\t\t\t\t\treturn false;","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t}","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t\treturn true;","\t\t\t\t};","\t\t\t\tme.options = function () {","\t\t\t\t\tvar data = {};","\t\t\t\t\tsimpleCart.each(_data,function (val, x, label) {","\t\t\t\t\t\tvar add = true;","\t\t\t\t\t\tsimpleCart.each(me.reservedFields(), function (field) {","\t\t\t\t\t\t\tif (field === label) {","\t\t\t\t\t\t\t\tadd = false;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t\treturn add;","\t\t\t\t\t\t});","","\t\t\t\t\t\tif (add) {","\t\t\t\t\t\t\tdata[label] = me.get(label);","\t\t\t\t\t\t}","\t\t\t\t\t});","\t\t\t\t\treturn data;","\t\t\t\t};","","","\t\t\t\tcheckQuantityAndPrice();","\t\t\t};","","\t\t\tsimpleCart.Item._ = simpleCart.Item.prototype = {","","\t\t\t\t// editing the item quantity","\t\t\t\tincrement: function (amount) {","\t\t\t\t\tvar diff = amount || 1;","\t\t\t\t\tdiff = parseInt(diff, 10);","","\t\t\t\t\tthis.quantity(this.quantity() + diff);","\t\t\t\t\tif (this.quantity() < 1) {","\t\t\t\t\t\tthis.remove();","\t\t\t\t\t\treturn null;","\t\t\t\t\t}","\t\t\t\t\treturn this;","","\t\t\t\t},","\t\t\t\tdecrement: function (amount) {","\t\t\t\t\tvar diff = amount || 1;","\t\t\t\t\treturn this.increment(-parseInt(diff, 10));","\t\t\t\t},","\t\t\t\tremove: function (skipUpdate) {","\t\t\t\t\tvar removeItemBool = simpleCart.trigger(\"beforeRemove\", [sc_items[this.id()]]);","\t\t\t\t\tif (removeItemBool === false ) {","\t\t\t\t\t\treturn false;","\t\t\t\t\t}","\t\t\t\t\tdelete sc_items[this.id()];","\t\t\t\t\tif (!skipUpdate) { ","\t\t\t\t\t\tsimpleCart.update();","\t\t\t\t\t}","\t\t\t\t\treturn null;","\t\t\t\t},","","\t\t\t\t// special fields for items","\t\t\t\treservedFields: function () {","\t\t\t\t\treturn ['quantity', 'id', 'item_number', 'price', 'name', 'shipping', 'tax', 'taxRate'];","\t\t\t\t},","","\t\t\t\t// return values for all reserved fields if they exist","\t\t\t\tfields: function () {","\t\t\t\t\tvar data = {},","\t\t\t\t\t\tme = this;","\t\t\t\t\tsimpleCart.each(me.reservedFields(), function (field) {","\t\t\t\t\t\tif (me.get(field)) {","\t\t\t\t\t\t\tdata[field] = me.get(field);","\t\t\t\t\t\t}","\t\t\t\t\t});","\t\t\t\t\treturn data;","\t\t\t\t},","","","\t\t\t\t// shortcuts for getter/setters. can","\t\t\t\t// be overwritten for customization","\t\t\t\t// btw, we are hiring at wojo design, and could","\t\t\t\t// use a great web designer. if thats you, you can","\t\t\t\t// get more info at http://wojodesign.com/now-hiring/","\t\t\t\t// or email me directly: brett@wojodesign.com","\t\t\t\tquantity: function (val) {","\t\t\t\t\treturn isUndefined(val) ? parseInt(this.get(\"quantity\", true) || 1, 10) : this.set(\"quantity\", val);","\t\t\t\t},","\t\t\t\tprice: function (val) {","\t\t\t\t\treturn isUndefined(val) ?","\t\t\t\t\t\t\tparseFloat((this.get(\"price\",true).toString()).replace(simpleCart.currency().symbol,\"\").replace(simpleCart.currency().delimiter,\"\") || 1) :","\t\t\t\t\t\t\tthis.set(\"price\", parseFloat((val).toString().replace(simpleCart.currency().symbol,\"\").replace(simpleCart.currency().delimiter,\"\")));","\t\t\t\t},","\t\t\t\tid: function () {","\t\t\t\t\treturn this.get('id',false);","\t\t\t\t},","\t\t\t\ttotal:function () {","\t\t\t\t\treturn this.quantity()*this.price();","\t\t\t\t}","","\t\t\t};","","","","","\t\t\t/*******************************************************************","\t\t\t *\tCHECKOUT MANAGEMENT","\t\t\t *******************************************************************/","","\t\t\tsimpleCart.extend({","\t\t\t\tcheckout: function () {","\t\t\t\t\tif (settings.checkout.type.toLowerCase() === 'custom' && isFunction(settings.checkout.fn)) {","\t\t\t\t\t\tsettings.checkout.fn.call(simpleCart,settings.checkout);","\t\t\t\t\t} else if (isFunction(simpleCart.checkout[settings.checkout.type])) {","\t\t\t\t\t\tvar checkoutData = simpleCart.checkout[settings.checkout.type].call(simpleCart,settings.checkout);","\t\t\t\t\t\t","\t\t\t\t\t\t// if the checkout method returns data, try to send the form","\t\t\t\t\t\tif( checkoutData.data && checkoutData.action && checkoutData.method ){","\t\t\t\t\t\t\t// if no one has any objections, send the checkout form","\t\t\t\t\t\t\tif( false !== simpleCart.trigger('beforeCheckout', [checkoutData.data]) ){","\t\t\t\t\t\t\t\tsimpleCart.generateAndSendForm( checkoutData );","\t\t\t\t\t\t\t}","\t\t\t\t\t\t}","\t\t\t\t\t\t","\t\t\t\t\t} else {","\t\t\t\t\t\tsimpleCart.error(\"No Valid Checkout Method Specified\");","\t\t\t\t\t}","\t\t\t\t},","\t\t\t\textendCheckout: function (methods) {","\t\t\t\t\treturn simpleCart.extend(simpleCart.checkout, methods);","\t\t\t\t},","\t\t\t\tgenerateAndSendForm: function (opts) {","\t\t\t\t\tvar form = simpleCart.$create(\"form\");","\t\t\t\t\tform.attr('style', 'display:none;');","\t\t\t\t\tform.attr('action', opts.action);","\t\t\t\t\tform.attr('method', opts.method);","\t\t\t\t\tsimpleCart.each(opts.data, function (val, x, name) {","\t\t\t\t\t\tform.append(","\t\t\t\t\t\t\tsimpleCart.$create(\"input\").attr(\"type\",\"hidden\").attr(\"name\",name).val(val)","\t\t\t\t\t\t);","\t\t\t\t\t});","\t\t\t\t\tsimpleCart.$(\"body\").append(form);","\t\t\t\t\tform.el.submit();","\t\t\t\t\tform.remove();","\t\t\t\t}","\t\t\t});","","\t\t\tsimpleCart.extendCheckout({","\t\t\t\tPayPal: function (opts) {","\t\t\t\t\t// account email is required","\t\t\t\t\tif (!opts.email) {","\t\t\t\t\t\treturn simpleCart.error(\"No email provided for PayPal checkout\");","\t\t\t\t\t}","","\t\t\t\t\t// build basic form options","\t\t\t\t\tvar data = {","\t\t\t\t\t\t\t  cmd\t\t\t: \"_cart\"","\t\t\t\t\t\t\t, upload\t\t: \"1\"","\t\t\t\t\t\t\t, currency_code : simpleCart.currency().code","\t\t\t\t\t\t\t, business\t\t: opts.email","\t\t\t\t\t\t\t, rm\t\t\t: opts.method === \"GET\" ? \"0\" : \"2\"","\t\t\t\t\t\t\t, tax_cart\t\t: (simpleCart.tax()*1).toFixed(2)","\t\t\t\t\t\t\t, handling_cart : (simpleCart.shipping()*1).toFixed(2)","\t\t\t\t\t\t\t, charset\t\t: \"utf-8\"","\t\t\t\t\t\t},","\t\t\t\t\t\taction = opts.sandbox ? \"https://www.sandbox.paypal.com/cgi-bin/webscr\" : \"https://www.paypal.com/cgi-bin/webscr\",","\t\t\t\t\t\tmethod = opts.method === \"GET\" ? \"GET\" : \"POST\";","","","\t\t\t\t\t// check for return and success URLs in the options","\t\t\t\t\tif (opts.success) {","\t\t\t\t\t\tdata['return'] = opts.success;","\t\t\t\t\t}","\t\t\t\t\tif (opts.cancel) {","\t\t\t\t\t\tdata.cancel_return = opts.cancel;","\t\t\t\t\t}","\t\t\t\t\tif (opts.notify) {","\t\t\t\t\t\tdata.notify_url = opts.notify;","\t\t\t\t\t}","","","\t\t\t\t\t// add all the items to the form data","\t\t\t\t\tsimpleCart.each(function (item,x) {","\t\t\t\t\t\tvar counter = x+1,","\t\t\t\t\t\t\titem_options = item.options(),","\t\t\t\t\t\t\toptionCount = 0,","\t\t\t\t\t\t\tsend;","\t","\t\t\t\t\t\t// basic item data","\t\t\t\t\t\tdata[\"item_name_\" + counter] = item.get(\"name\");","\t\t\t\t\t\tdata[\"quantity_\" + counter] = item.quantity();","\t\t\t\t\t\tdata[\"amount_\" + counter] = (item.price()*1).toFixed(2);","\t\t\t\t\t\tdata[\"item_number_\" + counter] = item.get(\"item_number\") || counter;","","","\t\t\t\t\t\t// add the options","\t\t\t\t\t\tsimpleCart.each(item_options, function (val,k,attr) {","\t\t\t\t\t\t\t// paypal limits us to 10 options","\t\t\t\t\t\t\tif (k < 10) {","\t\t","\t\t\t\t\t\t\t\t// check to see if we need to exclude this from checkout","\t\t\t\t\t\t\t\tsend = true;","\t\t\t\t\t\t\t\tsimpleCart.each(settings.excludeFromCheckout, function (field_name) {","\t\t\t\t\t\t\t\t\tif (field_name === attr) { send = false; }","\t\t\t\t\t\t\t\t});","\t\t\t\t\t\t\t\tif (send) {","\t\t\t\t\t\t\t\t\t\toptionCount += 1;","\t\t\t\t\t\t\t\t\t\tdata[\"on\" + k + \"_\" + counter] = attr;","\t\t\t\t\t\t\t\t\t\tdata[\"os\" + k + \"_\" + counter] = val;","\t\t\t\t\t\t\t\t}","\t","\t\t\t\t\t\t\t}","\t\t\t\t\t\t});","","\t\t\t\t\t\t// options count","\t\t\t\t\t\tdata[\"option_index_\"+ x] = Math.min(10, optionCount);","\t\t\t\t\t});","","","\t\t\t\t\t// return the data for the checkout form","\t\t\t\t\treturn {","\t\t\t\t\t\t  action\t: action","\t\t\t\t\t\t, method\t: method","\t\t\t\t\t\t, data\t\t: data","\t\t\t\t\t};","","\t\t\t\t},","","","\t\t\t\tGoogleCheckout: function (opts) {","\t\t\t\t\t// account id is required","\t\t\t\t\tif (!opts.merchantID) {","\t\t\t\t\t\treturn simpleCart.error(\"No merchant id provided for GoogleCheckout\");","\t\t\t\t\t}","","\t\t\t\t\t// google only accepts USD and GBP","\t\t\t\t\tif (simpleCart.currency().code !== \"USD\" && simpleCart.currency().code !== \"GBP\") {","\t\t\t\t\t\treturn simpleCart.error(\"Google Checkout only accepts USD and GBP\");","\t\t\t\t\t}","","\t\t\t\t\t// build basic form options","\t\t\t\t\tvar data = {","\t\t\t\t\t\t\t// TODO: better shipping support for this google","\t\t\t\t\t\t\t  ship_method_name_1\t: \"Shipping\"","\t\t\t\t\t\t\t, ship_method_price_1\t: simpleCart.shipping()","\t\t\t\t\t\t\t, ship_method_currency_1: simpleCart.currency().code","\t\t\t\t\t\t\t, _charset_\t\t\t\t: ''","\t\t\t\t\t\t},","\t\t\t\t\t\taction = \"https://checkout.google.com/api/checkout/v2/checkoutForm/Merchant/\" + opts.merchantID,","\t\t\t\t\t\tmethod = opts.method === \"GET\" ? \"GET\" : \"POST\";","","","\t\t\t\t\t// add items to data","\t\t\t\t\tsimpleCart.each(function (item,x) {","\t\t\t\t\t\tvar counter = x+1,","\t\t\t\t\t\t\toptions_list = [],","\t\t\t\t\t\t\tsend;","\t\t\t\t\t\tdata['item_name_' + counter]\t\t= item.get('name');","\t\t\t\t\t\tdata['item_quantity_' + counter]\t= item.quantity();","\t\t\t\t\t\tdata['item_price_' + counter]\t\t= item.price();","\t\t\t\t\t\tdata['item_currency_ ' + counter]\t= simpleCart.currency().code;","\t\t\t\t\t\tdata['item_tax_rate' + counter]\t\t= item.get('taxRate') || simpleCart.taxRate();","","\t\t\t\t\t\t// create array of extra options","\t\t\t\t\t\tsimpleCart.each(item.options(), function (val,x,attr) {","\t\t\t\t\t\t\t// check to see if we need to exclude this from checkout","\t\t\t\t\t\t\tsend = true;","\t\t\t\t\t\t\tsimpleCart.each(settings.excludeFromCheckout, function (field_name) {","\t\t\t\t\t\t\t\tif (field_name === attr) { send = false; }","\t\t\t\t\t\t\t});","\t\t\t\t\t\t\tif (send) {","\t\t\t\t\t\t\t\toptions_list.push(attr + \": \" + val);","\t\t\t\t\t\t\t}","\t\t\t\t\t\t});","","\t\t\t\t\t\t// add the options to the description","\t\t\t\t\t\tdata['item_description_' + counter] = options_list.join(\", \");","\t\t\t\t\t});","","\t\t\t\t\t// return the data for the checkout form","\t\t\t\t\treturn {","\t\t\t\t\t\t  action\t: action","\t\t\t\t\t\t, method\t: method","\t\t\t\t\t\t, data\t\t: data","\t\t\t\t\t};","","","\t\t\t\t},","","","\t\t\t\tAmazonPayments: function (opts) {","\t\t\t\t\t// required options","\t\t\t\t\tif (!opts.merchant_signature) {","\t\t\t\t\t\treturn simpleCart.error(\"No merchant signature provided for Amazon Payments\");","\t\t\t\t\t}","\t\t\t\t\tif (!opts.merchant_id) {","\t\t\t\t\t\treturn simpleCart.error(\"No merchant id provided for Amazon Payments\");","\t\t\t\t\t}","\t\t\t\t\tif (!opts.aws_access_key_id) {","\t\t\t\t\t\treturn simpleCart.error(\"No AWS access key id provided for Amazon Payments\");","\t\t\t\t\t}","","","\t\t\t\t\t// build basic form options","\t\t\t\t\tvar data = {","\t\t\t\t\t\t\t  aws_access_key_id:\topts.aws_access_key_id","\t\t\t\t\t\t\t, merchant_signature:\topts.merchant_signature","\t\t\t\t\t\t\t, currency_code:\t\tsimpleCart.currency().code","\t\t\t\t\t\t\t, tax_rate:\t\t\t\tsimpleCart.taxRate()","\t\t\t\t\t\t\t, weight_unit:\t\t\topts.weight_unit || 'lb'","\t\t\t\t\t\t},","\t\t\t\t\t\taction = \"https://payments\" + (opts.sandbox ? \"-sandbox\" : \"\") + \".amazon.com/checkout/\" + opts.merchant_id,","\t\t\t\t\t\tmethod = opts.method === \"GET\" ? \"GET\" : \"POST\";","","","\t\t\t\t\t// add items to data","\t\t\t\t\tsimpleCart.each(function (item,x) {","\t\t\t\t\t\tvar counter = x+1,","\t\t\t\t\t\t\toptions_list = [];","\t\t\t\t\t\tdata['item_title_' + counter]\t\t\t= item.get('name');","\t\t\t\t\t\tdata['item_quantity_' + counter]\t\t= item.quantity();","\t\t\t\t\t\tdata['item_price_' + counter]\t\t\t= item.price();","\t\t\t\t\t\tdata['item_sku_ ' + counter]\t\t\t= item.get('sku') || item.id();","\t\t\t\t\t\tdata['item_merchant_id_' + counter]\t= opts.merchant_id;","\t\t\t\t\t\tif (item.get('weight')) {","\t\t\t\t\t\t\tdata['item_weight_' + counter]\t\t= item.get('weight');","\t\t\t\t\t\t}","\t\t\t\t\t\tif (settings.shippingQuantityRate) {","\t\t\t\t\t\t\tdata['shipping_method_price_per_unit_rate_' + counter] = settings.shippingQuantityRate;","\t\t\t\t\t\t}","","","\t\t\t\t\t\t// create array of extra options","\t\t\t\t\t\tsimpleCart.each(item.options(), function (val,x,attr) {","\t\t\t\t\t\t\t// check to see if we need to exclude this from checkout","\t\t\t\t\t\t\tvar send = true;","\t\t\t\t\t\t\tsimpleCart.each(settings.excludeFromCheckout, function (field_name) {","\t\t\t\t\t\t\t\tif (field_name === attr) { send = false; }","\t\t\t\t\t\t\t});","\t\t\t\t\t\t\tif (send && attr !== 'weight' && attr !== 'tax') {","\t\t\t\t\t\t\t\toptions_list.push(attr + \": \" + val);","\t\t\t\t\t\t\t}","\t\t\t\t\t\t});","","\t\t\t\t\t\t// add the options to the description","\t\t\t\t\t\tdata['item_description_' + counter] = options_list.join(\", \");","\t\t\t\t\t});","","\t\t\t\t\t// return the data for the checkout form","\t\t\t\t\treturn {","\t\t\t\t\t\t  action\t: action","\t\t\t\t\t\t, method\t: method","\t\t\t\t\t\t, data\t\t: data","\t\t\t\t\t};","","\t\t\t\t},","","","\t\t\t\tSendForm: function (opts) {","\t\t\t\t\t// url required","\t\t\t\t\tif (!opts.url) {","\t\t\t\t\t\treturn simpleCart.error('URL required for SendForm Checkout');","\t\t\t\t\t}","","\t\t\t\t\t// build basic form options","\t\t\t\t\tvar data = {","\t\t\t\t\t\t\t  currency\t: simpleCart.currency().code","\t\t\t\t\t\t\t, shipping\t: simpleCart.shipping()","\t\t\t\t\t\t\t, tax\t\t: simpleCart.tax()","\t\t\t\t\t\t\t, taxRate\t: simpleCart.taxRate()","\t\t\t\t\t\t\t, itemCount : simpleCart.find({}).length","\t\t\t\t\t\t},","\t\t\t\t\t\taction = opts.url,","\t\t\t\t\t\tmethod = opts.method === \"GET\" ? \"GET\" : \"POST\";","","","\t\t\t\t\t// add items to data","\t\t\t\t\tsimpleCart.each(function (item,x) {","\t\t\t\t\t\tvar counter = x+1,","\t\t\t\t\t\t\toptions_list = [],","\t\t\t\t\t\t\tsend;","\t\t\t\t\t\tdata['item_name_' + counter]\t\t= item.get('name');","\t\t\t\t\t\tdata['item_quantity_' + counter]\t= item.quantity();","\t\t\t\t\t\tdata['item_price_' + counter]\t\t= item.price();","","\t\t\t\t\t\t// create array of extra options","\t\t\t\t\t\tsimpleCart.each(item.options(), function (val,x,attr) {","\t\t\t\t\t\t\t// check to see if we need to exclude this from checkout","\t\t\t\t\t\t\tsend = true;","\t\t\t\t\t\t\tsimpleCart.each(settings.excludeFromCheckout, function (field_name) {","\t\t\t\t\t\t\t\tif (field_name === attr) { send = false; }","\t\t\t\t\t\t\t});","\t\t\t\t\t\t\tif (send) {","\t\t\t\t\t\t\t\toptions_list.push(attr + \": \" + val);","\t\t\t\t\t\t\t}","\t\t\t\t\t\t});","","\t\t\t\t\t\t// add the options to the description","\t\t\t\t\t\tdata['item_options_' + counter] = options_list.join(\", \");","\t\t\t\t\t});","","","\t\t\t\t\t// check for return and success URLs in the options","\t\t\t\t\tif (opts.success) {","\t\t\t\t\t\tdata['return'] = opts.success;","\t\t\t\t\t}","\t\t\t\t\tif (opts.cancel) {","\t\t\t\t\t\tdata.cancel_return = opts.cancel;","\t\t\t\t\t}","","\t\t\t\t\tif (opts.extra_data) {","\t\t\t\t\t\tdata = simpleCart.extend(data,opts.extra_data);","\t\t\t\t\t}","","\t\t\t\t\t// return the data for the checkout form","\t\t\t\t\treturn {","\t\t\t\t\t\t  action\t: action","\t\t\t\t\t\t, method\t: method","\t\t\t\t\t\t, data\t\t: data","\t\t\t\t\t};","\t\t\t\t}","","","\t\t\t});","","","\t\t\t/*******************************************************************","\t\t\t *\tEVENT MANAGEMENT","\t\t\t *******************************************************************/","\t\t\teventFunctions = {","","\t\t\t\t// bind a callback to an event","\t\t\t\tbind: function (name, callback) {","\t\t\t\t\tif (!isFunction(callback)) {","\t\t\t\t\t\treturn this;","\t\t\t\t\t}","","\t\t\t\t\tif (!this._events) {","\t\t\t\t\t\tthis._events = {};","\t\t\t\t\t}","\t\t\t\t\t","\t\t\t\t\t// split by spaces to allow for multiple event bindings at once","\t\t\t\t\tvar eventNameList = name.split(/ +/);","\t\t\t\t\t","\t\t\t\t\t// iterate through and bind each event","\t\t\t\t\tsimpleCart.each( eventNameList , function( eventName ){","\t\t\t\t\t\tif (this._events[eventName] === true) {","\t\t\t\t\t\t\tcallback.apply(this);","\t\t\t\t\t\t} else if (!isUndefined(this._events[eventName])) {","\t\t\t\t\t\t\tthis._events[eventName].push(callback);","\t\t\t\t\t\t} else {","\t\t\t\t\t\t\tthis._events[eventName] = [callback];","\t\t\t\t\t\t}","\t\t\t\t\t});","","\t\t\t\t\t","\t\t\t\t\treturn this;","\t\t\t\t},","\t\t\t\t","\t\t\t\t// trigger event","\t\t\t\ttrigger: function (name, options) {","\t\t\t\t\tvar returnval = true,","\t\t\t\t\t\tx,","\t\t\t\t\t\txlen;","","\t\t\t\t\tif (!this._events) {","\t\t\t\t\t\tthis._events = {};","\t\t\t\t\t}","\t\t\t\t\tif (!isUndefined(this._events[name]) && isFunction(this._events[name][0])) {","\t\t\t\t\t\tfor (x = 0, xlen = this._events[name].length; x < xlen; x += 1) {","\t\t\t\t\t\t\treturnval = this._events[name][x].apply(this, (options || []));","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t\tif (returnval === false) {","\t\t\t\t\t\treturn false;","\t\t\t\t\t}","\t\t\t\t\treturn true;","\t\t\t\t}","","\t\t\t};","\t\t\t// alias for bind","\t\t\teventFunctions.on = eventFunctions.bind;","\t\t\tsimpleCart.extend(eventFunctions);","\t\t\tsimpleCart.extend(simpleCart.Item._, eventFunctions);","","","\t\t\t// base simpleCart events in options","\t\t\tbaseEvents = {","\t\t\t\t  beforeAdd\t\t\t\t: null","\t\t\t\t, afterAdd\t\t\t\t: null","\t\t\t\t, load\t\t\t\t\t: null","\t\t\t\t, beforeSave\t\t\t: null","\t\t\t\t, afterSave\t\t\t\t: null","\t\t\t\t, update\t\t\t\t: null","\t\t\t\t, ready\t\t\t\t\t: null","\t\t\t\t, checkoutSuccess\t\t: null","\t\t\t\t, checkoutFail\t\t\t: null","\t\t\t\t, beforeCheckout\t\t: null","\t\t\t\t, beforeRemove\t\t\t: null","\t\t\t};","\t\t\t","\t\t\t// extend with base events","\t\t\tsimpleCart(baseEvents);","","\t\t\t// bind settings to events","\t\t\tsimpleCart.each(baseEvents, function (val, x, name) {","\t\t\t\tsimpleCart.bind(name, function () {","\t\t\t\t\tif (isFunction(settings[name])) {","\t\t\t\t\t\tsettings[name].apply(this, arguments);","\t\t\t\t\t}","\t\t\t\t});","\t\t\t});","","\t\t\t/*******************************************************************","\t\t\t *\tFORMATTING FUNCTIONS","\t\t\t *******************************************************************/","\t\t\tsimpleCart.extend({","\t\t\t\ttoCurrency: function (number,opts) {","\t\t\t\t\tvar num = parseFloat(number),","\t\t\t\t\t\topt_input = opts || {},","\t\t\t\t\t\t_opts = simpleCart.extend(simpleCart.extend({","\t\t\t\t\t\t\t  symbol:\t\t\"$\"","\t\t\t\t\t\t\t, decimal:\t\t\".\"","\t\t\t\t\t\t\t, delimiter:\t\",\"","\t\t\t\t\t\t\t, accuracy:\t\t2","\t\t\t\t\t\t\t, after: false","\t\t\t\t\t\t}, simpleCart.currency()), opt_input),","","\t\t\t\t\t\tnumParts = num.toFixed(_opts.accuracy).split(\".\"),","\t\t\t\t\t\tdec = numParts[1],","\t\t\t\t\t\tints = numParts[0];","\t\t\t","\t\t\t\t\tints = simpleCart.chunk(ints.reverse(), 3).join(_opts.delimiter.reverse()).reverse();","","\t\t\t\t\treturn\t(!_opts.after ? _opts.symbol : \"\") +","\t\t\t\t\t\t\tints +","\t\t\t\t\t\t\t(dec ? _opts.decimal + dec : \"\") +","\t\t\t\t\t\t\t(_opts.after ? _opts.symbol : \"\");","\t","\t\t\t\t},","","","\t\t\t\t// break a string in blocks of size n","\t\t\t\tchunk: function (str, n) {","\t\t\t\t\tif (typeof n==='undefined') {","\t\t\t\t\t\tn=2;","\t\t\t\t\t}","\t\t\t\t\tvar result = str.match(new RegExp('.{1,' + n + '}','g'));","\t\t\t\t\treturn result || [];","\t\t\t\t}","","\t\t\t});","","","\t\t\t// reverse string function","\t\t\tString.prototype.reverse = function () {","\t\t\t\treturn this.split(\"\").reverse().join(\"\");","\t\t\t};","","","\t\t\t// currency functions","\t\t\tsimpleCart.extend({","\t\t\t\tcurrency: function (currency) {","\t\t\t\t\tif (isString(currency) && !isUndefined(currencies[currency])) {","\t\t\t\t\t\tsettings.currency = currency;","\t\t\t\t\t} else if (isObject(currency)) {","\t\t\t\t\t\tcurrencies[currency.code] = currency;","\t\t\t\t\t\tsettings.currency = currency.code;","\t\t\t\t\t} else {","\t\t\t\t\t\treturn currencies[settings.currency];","\t\t\t\t\t}","\t\t\t\t}","\t\t\t});","","","\t\t\t/*******************************************************************","\t\t\t *\tVIEW MANAGEMENT","\t\t\t *******************************************************************/","","\t\t\tsimpleCart.extend({","\t\t\t\t// bind outlets to function","\t\t\t\tbindOutlets: function (outlets) {","\t\t\t\t\tsimpleCart.each(outlets, function (callback, x, selector) {","\t\t\t\t\t\t","\t\t\t\t\t\tsimpleCart.bind('update', function () {","\t\t\t\t\t\t\tsimpleCart.setOutlet(\".\" + namespace + \"_\" + selector, callback);","\t\t\t\t\t\t});","\t\t\t\t\t});","\t\t\t\t},","","\t\t\t\t// set function return to outlet","\t\t\t\tsetOutlet: function (selector, func) {","\t\t\t\t\tvar val = func.call(simpleCart, selector);","\t\t\t\t\tif (isObject(val) && val.el) {","\t\t\t\t\t\tsimpleCart.$(selector).html(' ').append(val);","\t\t\t\t\t} else if (!isUndefined(val)) {","\t\t\t\t\t\tsimpleCart.$(selector).html(val);","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\t// bind click events on inputs","\t\t\t\tbindInputs: function (inputs) {","\t\t\t\t\tsimpleCart.each(inputs, function (info) {","\t\t\t\t\t\tsimpleCart.setInput(\".\" + namespace + \"_\" + info.selector, info.event, info.callback);","\t\t\t\t\t});","\t\t\t\t},","","\t\t\t\t// attach events to inputs\t","\t\t\t\tsetInput: function (selector, event, func) {","\t\t\t\t\tsimpleCart.$(selector).live(event, func);","\t\t\t\t}","\t\t\t});\t\t","","","\t\t\t// class for wrapping DOM selector shit","\t\t\tsimpleCart.ELEMENT = function (selector) {","","\t\t\t\tthis.create(selector);","\t\t\t\tthis.selector = selector || null; // \"#\" + this.attr('id'); TODO: test length?","\t\t\t};","","\t\t\tsimpleCart.extend(selectorFunctions, {","","\t\t\t\t\"MooTools\"\t\t: {","\t\t\t\t\ttext: function (text) {","\t\t\t\t\t\treturn this.attr(_TEXT_, text);","\t\t\t\t\t},","\t\t\t\t\thtml: function (html) {","\t\t\t\t\t\treturn this.attr(_HTML_, html);","\t\t\t\t\t},","\t\t\t\t\tval: function (val) {","\t\t\t\t\t\treturn this.attr(_VALUE_, val);","\t\t\t\t\t},","\t\t\t\t\tattr: function (attr, val) {","\t\t\t\t\t\tif (isUndefined(val)) {","\t\t\t\t\t\t\treturn this.el[0] && this.el[0].get(attr);","\t\t\t\t\t\t}","\t\t\t\t\t\t","\t\t\t\t\t\tthis.el.set(attr, val);","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\tremove: function () {","\t\t\t\t\t\tthis.el.dispose();","\t\t\t\t\t\treturn null;","\t\t\t\t\t},","\t\t\t\t\taddClass: function (klass) {","\t\t\t\t\t\tthis.el.addClass(klass);","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\tremoveClass: function (klass) {","\t\t\t\t\t\tthis.el.removeClass(klass);","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\tappend: function (item) {","\t\t\t\t\t\tthis.el.adopt(item.el);","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\teach: function (callback) {","\t\t\t\t\t\tif (isFunction(callback)) {","\t\t\t\t\t\t\tsimpleCart.each(this.el, function( e, i, c) {","\t\t\t\t\t\t\t\tcallback.call( i, i, e, c );","\t\t\t\t\t\t\t});","\t\t\t\t\t\t}","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\tclick: function (callback) {","\t\t\t\t\t\tif (isFunction(callback)) {","\t\t\t\t\t\t\tthis.each(function (e) {","\t\t\t\t\t\t\t\te.addEvent(_CLICK_, function (ev) {","\t\t\t\t\t\t\t\t\tcallback.call(e,ev);","\t\t\t\t\t\t\t\t});","\t\t\t\t\t\t\t});","\t\t\t\t\t\t} else if (isUndefined(callback)) {","\t\t\t\t\t\t\tthis.el.fireEvent(_CLICK_);","\t\t\t\t\t\t}","","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\tlive: function (\tevent,callback) {","\t\t\t\t\t\tvar selector = this.selector;","\t\t\t\t\t\tif (isFunction(callback)) {","\t\t\t\t\t\t\tsimpleCart.$(\"body\").el.addEvent(event + \":relay(\" + selector + \")\", function (e, el) {","\t\t\t\t\t\t\t\tcallback.call(el, e);","\t\t\t\t\t\t\t});","\t\t\t\t\t\t}","\t\t\t\t\t},","\t\t\t\t\tmatch: function (selector) {","\t\t\t\t\t\treturn this.el.match(selector);","\t\t\t\t\t},","\t\t\t\t\tparent: function () {","\t\t\t\t\t\treturn simpleCart.$(this.el.getParent());","\t\t\t\t\t},","\t\t\t\t\tfind: function (selector) {","\t\t\t\t\t\treturn simpleCart.$(this.el.getElements(selector));","\t\t\t\t\t},","\t\t\t\t\tclosest: function (selector) {","\t\t\t\t\t\treturn simpleCart.$(this.el.getParent(selector));","\t\t\t\t\t},","\t\t\t\t\tdescendants: function () {","\t\t\t\t\t\treturn this.find(\"*\");","\t\t\t\t\t},","\t\t\t\t\ttag: function () {","\t\t\t\t\t\treturn this.el[0].tagName;","\t\t\t\t\t},","\t\t\t\t\tsubmit: function (){","\t\t\t\t\t\tthis.el[0].submit();","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\tcreate: function (selector) {","\t\t\t\t\t\tthis.el = $engine(selector);","\t\t\t\t\t}","","","\t\t\t\t},","","\t\t\t\t\"Prototype\"\t\t: {","\t\t\t\t\ttext: function (text) {","\t\t\t\t\t\tif (isUndefined(text)) {","\t\t\t\t\t\t\treturn this.el[0].innerHTML;","\t\t\t\t\t\t}","\t\t\t\t\t\tthis.each(function (i,e) {","\t\t\t\t\t\t\t$(e).update(text);","\t\t\t\t\t\t});","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\thtml: function (html) {","\t\t\t\t\t\treturn this.text(html);","\t\t\t\t\t},","\t\t\t\t\tval: function (val) {","\t\t\t\t\t\treturn this.attr(_VALUE_, val);","\t\t\t\t\t},","\t\t\t\t\tattr: function (attr, val) {","\t\t\t\t\t\tif (isUndefined(val)) {","\t\t\t\t\t\t\treturn this.el[0].readAttribute(attr);","\t\t\t\t\t\t}","\t\t\t\t\t\tthis.each(function (i,e) {","\t\t\t\t\t\t\t$(e).writeAttribute(attr, val);","\t\t\t\t\t\t});","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\tappend: function (item) {","\t\t\t\t\t\tthis.each(function (i,e) {","\t\t\t\t\t\t\tif (item.el) {","\t\t\t\t\t\t\t\titem.each(function (i2,e2) {","\t\t\t\t\t\t\t\t\t$(e).appendChild(e2);","\t\t\t\t\t\t\t\t});","\t\t\t\t\t\t\t} else if (isElement(item)) {","\t\t\t\t\t\t\t\t$(e).appendChild(item);","\t\t\t\t\t\t\t}","\t\t\t\t\t\t});","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\tremove: function () {","\t\t\t\t\t\tthis.each(function (i, e) {","\t\t\t\t\t\t\t$(e).remove();","\t\t\t\t\t\t});","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\taddClass: function (klass) {","\t\t\t\t\t\tthis.each(function (i, e) {","\t\t\t\t\t\t\t$(e).addClassName(klass);","\t\t\t\t\t\t});","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\tremoveClass: function (klass) {","\t\t\t\t\t\tthis.each(function (i, e) {","\t\t\t\t\t\t\t$(e).removeClassName(klass);","\t\t\t\t\t\t});","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\teach: function (callback) {","\t\t\t\t\t\tif (isFunction(callback)) {","\t\t\t\t\t\t\tsimpleCart.each(this.el, function( e, i, c) {","\t\t\t\t\t\t\t\tcallback.call( i, i, e, c );","\t\t\t\t\t\t\t});","\t\t\t\t\t\t}","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\tclick: function (callback) {","\t\t\t\t\t\tif (isFunction(callback)) {","\t\t\t\t\t\t\tthis.each(function (i, e) {","\t\t\t\t\t\t\t\t$(e).observe(_CLICK_, function (ev) {","\t\t\t\t\t\t\t\t\tcallback.call(e,ev);","\t\t\t\t\t\t\t\t});","\t\t\t\t\t\t\t});","\t\t\t\t\t\t} else if (isUndefined(callback)) {","\t\t\t\t\t\t\tthis.each(function (i, e) {","\t\t\t\t\t\t\t\t$(e).fire(_CLICK_);","\t\t\t\t\t\t\t});","\t\t\t\t\t\t}","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\tlive: function (event,callback) {","\t\t\t\t\t\tif (isFunction(callback)) {","\t\t\t\t\t\t\tvar selector = this.selector;","\t\t\t\t\t\t\tdocument.observe(event, function (e, el) {","\t\t\t\t\t\t\t\tif (el === $engine(e).findElement(selector)) {","\t\t\t\t\t\t\t\t\tcallback.call(el, e);","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t});","\t\t\t\t\t\t}","\t\t\t\t\t},","\t\t\t\t\tparent: function () {","\t\t\t\t\t\treturn simpleCart.$(this.el.up());","\t\t\t\t\t},","\t\t\t\t\tfind: function (selector) {","\t\t\t\t\t\treturn simpleCart.$(this.el.getElementsBySelector(selector));","\t\t\t\t\t},","\t\t\t\t\tclosest: function (selector) {","\t\t\t\t\t\treturn simpleCart.$(this.el.up(selector));","\t\t\t\t\t},","\t\t\t\t\tdescendants: function () {","\t\t\t\t\t\treturn simpleCart.$(this.el.descendants());","\t\t\t\t\t},","\t\t\t\t\ttag: function () {","\t\t\t\t\t\treturn this.el.tagName;","\t\t\t\t\t},","\t\t\t\t\tsubmit: function() {","\t\t\t\t\t\tthis.el[0].submit();","\t\t\t\t\t},","","\t\t\t\t\tcreate: function (selector) {","\t\t\t\t\t\tif (isString(selector)) {","\t\t\t\t\t\t\tthis.el = $engine(selector);","\t\t\t\t\t\t} else if (isElement(selector)) {","\t\t\t\t\t\t\tthis.el = [selector];","\t\t\t\t\t\t}","\t\t\t\t\t}","","","","\t\t\t\t},","","\t\t\t\t\"jQuery\": {","\t\t\t\t\tpassthrough: function (action, val) {","\t\t\t\t\t\tif (isUndefined(val)) {","\t\t\t\t\t\t\treturn this.el[action]();","\t\t\t\t\t\t}","\t\t\t\t\t\t","\t\t\t\t\t\tthis.el[action](val);","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\ttext: function (text) {","\t\t\t\t\t\treturn this.passthrough(_TEXT_, text);","\t\t\t\t\t},","\t\t\t\t\thtml: function (html) {","\t\t\t\t\t\treturn this.passthrough(_HTML_, html);","\t\t\t\t\t},","\t\t\t\t\tval: function (val) {","\t\t\t\t\t\treturn this.passthrough(\"val\", val);","\t\t\t\t\t},","\t\t\t\t\tappend: function (item) {","\t\t\t\t\t\tvar target = item.el || item;","\t\t\t\t\t\tthis.el.append(target);","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\tattr: function (attr, val) {","\t\t\t\t\t\tif (isUndefined(val)) {","\t\t\t\t\t\t\treturn this.el.attr(attr);","\t\t\t\t\t\t}","\t\t\t\t\t\tthis.el.attr(attr, val);","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\tremove: function () {","\t\t\t\t\t\tthis.el.remove();","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\taddClass: function (klass) {","\t\t\t\t\t\tthis.el.addClass(klass);","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\tremoveClass: function (klass) {","\t\t\t\t\t\tthis.el.removeClass(klass);","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\teach: function (callback) {","\t\t\t\t\t\treturn this.passthrough('each', callback);","\t\t\t\t\t},","\t\t\t\t\tclick: function (callback) {","\t\t\t\t\t\treturn this.passthrough(_CLICK_, callback);","\t\t\t\t\t},","\t\t\t\t\tlive: function (event, callback) {","\t\t\t\t\t\t$engine(document).delegate(this.selector, event, callback);","\t\t\t\t\t\treturn this;","\t\t\t\t\t},","\t\t\t\t\tparent: function () {","\t\t\t\t\t\treturn simpleCart.$(this.el.parent());","\t\t\t\t\t},","\t\t\t\t\tfind: function (selector) {","\t\t\t\t\t\treturn simpleCart.$(this.el.find(selector));","\t\t\t\t\t},","\t\t\t\t\tclosest: function (selector) {","\t\t\t\t\t\treturn simpleCart.$(this.el.closest(selector));","\t\t\t\t\t},","\t\t\t\t\ttag: function () {","\t\t\t\t\t\treturn this.el[0].tagName;","\t\t\t\t\t},","\t\t\t\t\tdescendants: function () {","\t\t\t\t\t\treturn simpleCart.$(this.el.find(\"*\"));","\t\t\t\t\t},","\t\t\t\t\tsubmit: function() {","\t\t\t\t\t\treturn this.el.submit();","\t\t\t\t\t},","","\t\t\t\t\tcreate: function (selector) {","\t\t\t\t\t\tthis.el = $engine(selector);","\t\t\t\t\t}","\t\t\t\t}","\t\t\t});","\t\t\tsimpleCart.ELEMENT._ = simpleCart.ELEMENT.prototype;","","\t\t\t// bind the DOM setup to the ready event","\t\t\tsimpleCart.ready(simpleCart.setupViewTool);","","\t\t\t// bind the input and output events","\t\t\tsimpleCart.ready(function () {","\t\t\t\tsimpleCart.bindOutlets({","\t\t\t\t\ttotal: function () {","\t\t\t\t\t\treturn simpleCart.toCurrency(simpleCart.total());","\t\t\t\t\t}","\t\t\t\t\t, quantity: function () {","\t\t\t\t\t\treturn simpleCart.quantity();","\t\t\t\t\t}","\t\t\t\t\t, items: function (selector) {","\t\t\t\t\t\tsimpleCart.writeCart(selector);","\t\t\t\t\t}","\t\t\t\t\t, tax: function () {","\t\t\t\t\t\treturn simpleCart.toCurrency(simpleCart.tax());","\t\t\t\t\t}","\t\t\t\t\t, taxRate: function () {","\t\t\t\t\t\treturn simpleCart.taxRate().toFixed();","\t\t\t\t\t}","\t\t\t\t\t, shipping: function () {","\t\t\t\t\t\treturn simpleCart.toCurrency(simpleCart.shipping());","\t\t\t\t\t}","\t\t\t\t\t, grandTotal: function () {","\t\t\t\t\t\treturn simpleCart.toCurrency(simpleCart.grandTotal());","\t\t\t\t\t}","\t\t\t\t});","\t\t\t\tsimpleCart.bindInputs([","\t\t\t\t\t{\t  selector: 'checkout'","\t\t\t\t\t\t, event: 'click'","\t\t\t\t\t\t, callback: function () {","\t\t\t\t\t\t\tsimpleCart.checkout();","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t\t, {\t  selector: 'empty'","\t\t\t\t\t\t, event: 'click'","\t\t\t\t\t\t, callback: function () {","\t\t\t\t\t\t\tsimpleCart.empty();","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t\t, {\t  selector: 'increment'","\t\t\t\t\t\t, event: 'click'","\t\t\t\t\t\t, callback: function () {","\t\t\t\t\t\t\tsimpleCart.find(simpleCart.$(this).closest('.itemRow').attr('id').split(\"_\")[1]).increment();","\t\t\t\t\t\t\tsimpleCart.update();","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t\t, {\t  selector: 'decrement'","\t\t\t\t\t\t, event: 'click'","\t\t\t\t\t\t, callback: function () {","\t\t\t\t\t\t\tsimpleCart.find(simpleCart.$(this).closest('.itemRow').attr('id').split(\"_\")[1]).decrement();","\t\t\t\t\t\t\tsimpleCart.update();","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t\t/* remove from cart */","\t\t\t\t\t, {\t  selector: 'remove'","\t\t\t\t\t\t, event: 'click'","\t\t\t\t\t\t, callback: function () {","\t\t\t\t\t\t\tsimpleCart.find(simpleCart.$(this).closest('.itemRow').attr('id').split(\"_\")[1]).remove();","\t\t\t\t\t\t}","\t\t\t\t\t}","","\t\t\t\t\t/* cart inputs */","\t\t\t\t\t, {\t  selector: 'input'","\t\t\t\t\t\t, event: 'change'","\t\t\t\t\t\t, callback: function () {","\t\t\t\t\t\t\tvar $input = simpleCart.$(this),","\t\t\t\t\t\t\t\t$parent = $input.parent(),","\t\t\t\t\t\t\t\tclassList = $parent.attr('class').split(\" \");","\t\t\t\t\t\t\tsimpleCart.each(classList, function (klass) {","\t\t\t\t\t\t\t\tif (klass.match(/item-.+/i)) {","\t\t\t\t\t\t\t\t\tvar field = klass.split(\"-\")[1];","\t\t\t\t\t\t\t\t\tsimpleCart.find($parent.closest('.itemRow').attr('id').split(\"_\")[1]).set(field,$input.val());","\t\t\t\t\t\t\t\t\tsimpleCart.update();","\t\t\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t});","\t\t\t\t\t\t}","\t\t\t\t\t}","","\t\t\t\t\t/* here is our shelfItem add to cart button listener */","\t\t\t\t\t, { selector: 'shelfItem .item_add'","\t\t\t\t\t\t, event: 'click'","\t\t\t\t\t\t, callback: function () {","\t\t\t\t\t\t\tvar $button = simpleCart.$(this),","\t\t\t\t\t\t\t\tfields = {};","","\t\t\t\t\t\t\t$button.closest(\".\" + namespace + \"_shelfItem\").descendants().each(function (x,item) {","\t\t\t\t\t\t\t\tvar $item = simpleCart.$(item);","","\t\t\t\t\t\t\t\t// check to see if the class matches the item_[fieldname] pattern","\t\t\t\t\t\t\t\tif ($item.attr(\"class\") &&","\t\t\t\t\t\t\t\t\t$item.attr(\"class\").match(/item_.+/) &&","\t\t\t\t\t\t\t\t\t!$item.attr('class').match(/item_add/)) {","","\t\t\t\t\t\t\t\t\t// find the class name","\t\t\t\t\t\t\t\t\tsimpleCart.each($item.attr('class').split(' '), function (klass) {","\t\t\t\t\t\t\t\t\t\tvar attr,","\t\t\t\t\t\t\t\t\t\t\tval,","\t\t\t\t\t\t\t\t\t\t\ttype;","","\t\t\t\t\t\t\t\t\t\t// get the value or text depending on the tagName","\t\t\t\t\t\t\t\t\t\tif (klass.match(/item_.+/)) {","\t\t\t\t\t\t\t\t\t\t\tattr = klass.split(\"_\")[1];","\t\t\t\t\t\t\t\t\t\t\tval = \"\";","\t\t\t\t\t\t\t\t\t\t\tswitch($item.tag().toLowerCase()) {","\t\t\t\t\t\t\t\t\t\t\t\tcase \"input\":","\t\t\t\t\t\t\t\t\t\t\t\tcase \"textarea\":","\t\t\t\t\t\t\t\t\t\t\t\tcase \"select\":","\t\t\t\t\t\t\t\t\t\t\t\t\ttype = $item.attr(\"type\");","\t\t\t\t\t\t\t\t\t\t\t\t\tif (!type || ((type.toLowerCase() === \"checkbox\" || type.toLowerCase() === \"radio\") && $item.attr(\"checked\")) || type.toLowerCase() === \"text\" || type.toLowerCase() === \"number\") {","\t\t\t\t\t\t\t\t\t\t\t\t\t\tval = $item.val();","\t\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t","\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\t\t\t\t\t\t\tcase \"img\":","\t\t\t\t\t\t\t\t\t\t\t\t\tval = $item.attr('src');","\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\t\t\t\t\t\t\tdefault:","\t\t\t\t\t\t\t\t\t\t\t\t\tval = $item.text();","\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\t\t\t\t\t\t}","","\t\t\t\t\t\t\t\t\t\t\tif (val !== null && val !== \"\") {","\t\t\t\t\t\t\t\t\t\t\t\tfields[attr.toLowerCase()] = fields[attr.toLowerCase()] ? fields[attr.toLowerCase()] + \", \" +  val : val;","\t\t\t\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t\t\t});","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t});","","\t\t\t\t\t\t\t// add the item","\t\t\t\t\t\t\tsimpleCart.add(fields);","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t]);","\t\t\t});","","","\t\t\t/*******************************************************************","\t\t\t *\tDOM READY","\t\t\t *******************************************************************/","\t\t\t// Cleanup functions for the document ready method","\t\t\t// used from jQuery","\t\t\t/*global DOMContentLoaded */","\t\t\tif (document.addEventListener) {","\t\t\t\twindow.DOMContentLoaded = function () {","\t\t\t\t\tdocument.removeEventListener(\"DOMContentLoaded\", DOMContentLoaded, false);","\t\t\t\t\tsimpleCart.init();","\t\t\t\t};","","\t\t\t} else if (document.attachEvent) {","\t\t\t\twindow.DOMContentLoaded = function () {","\t\t\t\t\t// Make sure body exists, at least, in case IE gets a little overzealous (ticket #5443).","\t\t\t\t\tif (document.readyState === \"complete\") {","\t\t\t\t\t\tdocument.detachEvent(\"onreadystatechange\", DOMContentLoaded);","\t\t\t\t\t\tsimpleCart.init();","\t\t\t\t\t}","\t\t\t\t};","\t\t\t}","\t\t\t// The DOM ready check for Internet Explorer","\t\t\t// used from jQuery","\t\t\tfunction doScrollCheck() {","\t\t\t\tif (simpleCart.isReady) {","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\ttry {","\t\t\t\t\t// If IE is used, use the trick by Diego Perini","\t\t\t\t\t// http://javascript.nwbox.com/IEContentLoaded/","\t\t\t\t\tdocument.documentElement.doScroll(\"left\");","\t\t\t\t} catch (e) {","\t\t\t\t\tsetTimeout(doScrollCheck, 1);","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\t// and execute any waiting functions","\t\t\t\tsimpleCart.init();","\t\t\t}","\t\t\t","\t\t\t// bind ready event used from jquery","\t\t\tfunction sc_BindReady () {","","\t\t\t\t// Catch cases where $(document).ready() is called after the","\t\t\t\t// browser event has already occurred.","\t\t\t\tif (document.readyState === \"complete\") {","\t\t\t\t\t// Handle it asynchronously to allow scripts the opportunity to delay ready","\t\t\t\t\treturn setTimeout(simpleCart.init, 1);","\t\t\t\t}","","\t\t\t\t// Mozilla, Opera and webkit nightlies currently support this event","\t\t\t\tif (document.addEventListener) {","\t\t\t\t\t// Use the handy event callback","\t\t\t\t\tdocument.addEventListener(\"DOMContentLoaded\", DOMContentLoaded, false);","","\t\t\t\t\t// A fallback to window.onload, that will always work","\t\t\t\t\twindow.addEventListener(\"load\", simpleCart.init, false);","","\t\t\t\t// If IE event model is used","\t\t\t\t} else if (document.attachEvent) {","\t\t\t\t\t// ensure firing before onload,","\t\t\t\t\t// maybe late but safe also for iframes","\t\t\t\t\tdocument.attachEvent(\"onreadystatechange\", DOMContentLoaded);","","\t\t\t\t\t// A fallback to window.onload, that will always work","\t\t\t\t\twindow.attachEvent(\"onload\", simpleCart.init);","","\t\t\t\t\t// If IE and not a frame","\t\t\t\t\t// continually check to see if the document is ready","\t\t\t\t\tvar toplevel = false;","","\t\t\t\t\ttry {","\t\t\t\t\t\ttoplevel = window.frameElement === null;","\t\t\t\t\t} catch (e) {}","","\t\t\t\t\tif (document.documentElement.doScroll && toplevel) {","\t\t\t\t\t\tdoScrollCheck();","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","","\t\t\t// bind the ready event","\t\t\tsc_BindReady();","","\t\t\treturn simpleCart;","\t\t};","","","\twindow.simpleCart = generateSimpleCart();","","}(window, document));","","/************ JSON *************/","var JSON;JSON||(JSON={});","(function () {function k(a) {return a<10?\"0\"+a:a}function o(a) {p.lastIndex=0;return p.test(a)?'\"'+a.replace(p,function (a) {var c=r[a];return typeof c===\"string\"?c:\"\\\\u\"+(\"0000\"+a.charCodeAt(0).toString(16)).slice(-4)})+'\"':'\"'+a+'\"'}function l(a,j) {var c,d,h,m,g=e,f,b=j[a];b&&typeof b===\"object\"&&typeof b.toJSON===\"function\"&&(b=b.toJSON(a));typeof i===\"function\"&&(b=i.call(j,a,b));switch(typeof b) {case \"string\":return o(b);case \"number\":return isFinite(b)?String(b):\"null\";case \"boolean\":case \"null\":return String(b);case \"object\":if (!b)return\"null\";","e += n;f=[];if (Object.prototype.toString.apply(b)===\"[object Array]\") {m=b.length;for (c=0;c<m;c += 1)f[c]=l(c,b)||\"null\";h=f.length===0?\"[]\":e?\"[\\n\"+e+f.join(\",\\n\"+e)+\"\\n\"+g+\"]\":\"[\"+f.join(\",\")+\"]\";e=g;return h}if (i&&typeof i===\"object\") {m=i.length;for (c=0;c<m;c += 1)typeof i[c]===\"string\"&&(d=i[c],(h=l(d,b))&&f.push(o(d)+(e?\": \":\":\")+h))}else for (d in b)Object.prototype.hasOwnProperty.call(b,d)&&(h=l(d,b))&&f.push(o(d)+(e?\": \":\":\")+h);h=f.length===0?\"{}\":e?\"{\\n\"+e+f.join(\",\\n\"+e)+\"\\n\"+g+\"}\":\"{\"+f.join(\",\")+","\"}\";e=g;return h}}if (typeof Date.prototype.toJSON!==\"function\")Date.prototype.toJSON=function () {return isFinite(this.valueOf())?this.getUTCFullYear()+\"-\"+k(this.getUTCMonth()+1)+\"-\"+k(this.getUTCDate())+\"T\"+k(this.getUTCHours())+\":\"+k(this.getUTCMinutes())+\":\"+k(this.getUTCSeconds())+\"Z\":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function () {return this.valueOf()};var q=/[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,","p=/[\\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,e,n,r={\"\\u0008\":\"\\\\b\",\"\\t\":\"\\\\t\",\"\\n\":\"\\\\n\",\"\\u000c\":\"\\\\f\",\"\\r\":\"\\\\r\",'\"':'\\\\\"',\"\\\\\":\"\\\\\\\\\"},i;if (typeof JSON.stringify!==\"function\")JSON.stringify=function (a,j,c) {var d;n=e=\"\";if (typeof c===\"number\")for (d=0;d<c;d += 1)n += \" \";else typeof c===\"string\"&&(n=c);if ((i=j)&&typeof j!==\"function\"&&(typeof j!==\"object\"||typeof j.length!==\"number\"))throw Error(\"JSON.stringify\");return l(\"\",","{\"\":a})};if (typeof JSON.parse!==\"function\")JSON.parse=function (a,e) {function c(a,d) {var g,f,b=a[d];if (b&&typeof b===\"object\")for (g in b)Object.prototype.hasOwnProperty.call(b,g)&&(f=c(b,g),f!==void 0?b[g]=f:delete b[g]);return e.call(a,d,b)}var d,a=String(a);q.lastIndex=0;q.test(a)&&(a=a.replace(q,function (a) {return\"\\\\u\"+(\"0000\"+a.charCodeAt(0).toString(16)).slice(-4)}));if (/^[\\],:{}\\s]*$/.test(a.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g,\"@\").replace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g,","\"]\").replace(/(?:^|:|,)(?:\\s*\\[)+/g,\"\")))return d=eval(\"(\"+a+\")\"),typeof e===\"function\"?c({\"\":d},\"\"):d;throw new SyntaxError(\"JSON.parse\");}})();","","","/************ HTML5 Local Storage Support *************/","(function () {if (!this.localStorage)if (this.globalStorage)try {this.localStorage=this.globalStorage}catch(e) {}else{var a=document.createElement(\"div\");a.style.display=\"none\";document.getElementsByTagName(\"head\")[0].appendChild(a);if (a.addBehavior) {a.addBehavior(\"#default#userdata\");var d=this.localStorage={length:0,setItem:function (b,d) {a.load(\"localStorage\");b=c(b);a.getAttribute(b)||this.length++;a.setAttribute(b,d);a.save(\"localStorage\")},getItem:function (b) {a.load(\"localStorage\");b=c(b);return a.getAttribute(b)},","removeItem:function (b) {a.load(\"localStorage\");b=c(b);a.removeAttribute(b);a.save(\"localStorage\");this.length=0},clear:function () {a.load(\"localStorage\");for (var b=0;attr=a.XMLDocument.documentElement.attributes[b++];)a.removeAttribute(attr.name);a.save(\"localStorage\");this.length=0},key:function (b) {a.load(\"localStorage\");return a.XMLDocument.documentElement.attributes[b]}},c=function (a) {return a.replace(/[^-._0-9A-Za-z\\xb7\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u037d\\u37f-\\u1fff\\u200c-\\u200d\\u203f\\u2040\\u2070-\\u218f]/g,","\"-\")};a.load(\"localStorage\");d.length=a.XMLDocument.documentElement.attributes.length}}})();",""],"id":1}]]},"ace":{"folds":[],"scrolltop":26488,"scrollleft":0,"selection":{"start":{"row":1931,"column":0},"end":{"row":1931,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":1891,"state":"start","mode":"ace/mode/text"}},"timestamp":1494766891234}